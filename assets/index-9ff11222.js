var ks=Object.defineProperty,$s=Object.defineProperties;var Rs=Object.getOwnPropertyDescriptors;var Vt=Object.getOwnPropertySymbols;var Mo=Object.prototype.hasOwnProperty,Ao=Object.prototype.propertyIsEnumerable;var Tn=Math.pow,Co=(e,t,n)=>t in e?ks(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,X=(e,t)=>{for(var n in t||(t={}))Mo.call(t,n)&&Co(e,n,t[n]);if(Vt)for(var n of Vt(t))Ao.call(t,n)&&Co(e,n,t[n]);return e},oe=(e,t)=>$s(e,Rs(t));var st=(e,t)=>{var n={};for(var o in e)Mo.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(e!=null&&Vt)for(var o of Vt(e))t.indexOf(o)<0&&Ao.call(e,o)&&(n[o]=e[o]);return n};import{j as q,B as nn,P as Is,T as Ds}from"./components-aa7e164c.js";import{a as Ps,r as w,g as zs,R as C}from"./react-vendor-1f763956.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();var _r,To=Ps;_r=To.createRoot,To.hydrateRoot;function de(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=de(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var Sr={exports:{}},Er={},Nr={exports:{}},Cr={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mt=w;function Os(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Hs=typeof Object.is=="function"?Object.is:Os,Ls=mt.useState,Bs=mt.useEffect,Vs=mt.useLayoutEffect,Fs=mt.useDebugValue;function Xs(e,t){var n=t(),o=Ls({inst:{value:n,getSnapshot:t}}),r=o[0].inst,i=o[1];return Vs(function(){r.value=n,r.getSnapshot=t,kn(r)&&i({inst:r})},[e,n,t]),Bs(function(){return kn(r)&&i({inst:r}),e(function(){kn(r)&&i({inst:r})})},[e]),Fs(n),n}function kn(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Hs(e,n)}catch(o){return!0}}function Ys(e,t){return t()}var Ws=typeof window=="undefined"||typeof window.document=="undefined"||typeof window.document.createElement=="undefined"?Ys:Xs;Cr.useSyncExternalStore=mt.useSyncExternalStore!==void 0?mt.useSyncExternalStore:Ws;Nr.exports=Cr;var Us=Nr.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gn=w,Gs=Us;function Ks(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Zs=typeof Object.is=="function"?Object.is:Ks,qs=Gs.useSyncExternalStore,js=gn.useRef,Js=gn.useEffect,Qs=gn.useMemo,ea=gn.useDebugValue;Er.useSyncExternalStoreWithSelector=function(e,t,n,o,r){var i=js(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=Qs(function(){function c(g){if(!u){if(u=!0,l=g,g=o(g),r!==void 0&&s.hasValue){var y=s.value;if(r(y,g))return f=y}return f=g}if(y=f,Zs(l,g))return y;var m=o(g);return r!==void 0&&r(y,m)?(l=g,y):(l=g,f=m)}var u=!1,l,f,d=n===void 0?null:n;return[function(){return c(t())},d===null?void 0:function(){return c(d())}]},[t,n,o,r]);var a=qs(e,i[0],i[1]);return Js(function(){s.hasValue=!0,s.value=a},[a]),ea(a),a};Sr.exports=Er;var ta=Sr.exports;const na=zs(ta),ko=e=>{let t;const n=new Set,o=(l,f)=>{const d=typeof l=="function"?l(t):l;if(!Object.is(d,t)){const g=t;t=(f!=null?f:typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(y=>y(t,g))}},r=()=>t,c={setState:o,getState:r,getInitialState:()=>u,subscribe:l=>(n.add(l),()=>n.delete(l)),destroy:()=>{n.clear()}},u=t=e(o,r,c);return c},oa=e=>e?ko(e):ko,{useDebugValue:ra}=C,{useSyncExternalStoreWithSelector:ia}=na,sa=e=>e;function Mr(e,t=sa,n){const o=ia(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return ra(o),o}const $o=(e,t)=>{const n=oa(e),o=(r,i=t)=>Mr(n,r,i);return Object.assign(o,n),o},aa=(e,t)=>e?$o(e,t):$o;function le(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,r]of e)if(!Object.is(r,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var ca={value:()=>{}};function mn(){for(var e=0,t=arguments.length,n={},o;e<t;++e){if(!(o=arguments[e]+"")||o in n||/[\s.]/.test(o))throw new Error("illegal type: "+o);n[o]=[]}return new Jt(n)}function Jt(e){this._=e}function la(e,t){return e.trim().split(/^|\s+/).map(function(n){var o="",r=n.indexOf(".");if(r>=0&&(o=n.slice(r+1),n=n.slice(0,r)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:o}})}Jt.prototype=mn.prototype={constructor:Jt,on:function(e,t){var n=this._,o=la(e+"",n),r,i=-1,s=o.length;if(arguments.length<2){for(;++i<s;)if((r=(e=o[i]).type)&&(r=ua(n[r],e.name)))return r;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<s;)if(r=(e=o[i]).type)n[r]=Ro(n[r],e.name,t);else if(t==null)for(r in n)n[r]=Ro(n[r],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Jt(e)},call:function(e,t){if((r=arguments.length-2)>0)for(var n=new Array(r),o=0,r,i;o<r;++o)n[o]=arguments[o+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],o=0,r=i.length;o<r;++o)i[o].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var o=this._[e],r=0,i=o.length;r<i;++r)o[r].value.apply(t,n)}};function ua(e,t){for(var n=0,o=e.length,r;n<o;++n)if((r=e[n]).name===t)return r.value}function Ro(e,t,n){for(var o=0,r=e.length;o<r;++o)if(e[o].name===t){e[o]=ca,e=e.slice(0,o).concat(e.slice(o+1));break}return n!=null&&e.push({name:t,value:n}),e}var Vn="http://www.w3.org/1999/xhtml";const Io={svg:"http://www.w3.org/2000/svg",xhtml:Vn,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function pn(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Io.hasOwnProperty(t)?{space:Io[t],local:e}:e}function fa(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Vn&&t.documentElement.namespaceURI===Vn?t.createElement(e):t.createElementNS(n,e)}}function da(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Ar(e){var t=pn(e);return(t.local?da:fa)(t)}function ha(){}function oo(e){return e==null?ha:function(){return this.querySelector(e)}}function ga(e){typeof e!="function"&&(e=oo(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=new Array(s),c,u,l=0;l<s;++l)(c=i[l])&&(u=e.call(c,c.__data__,l,i))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new pe(o,this._parents)}function ma(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function pa(){return[]}function Tr(e){return e==null?pa:function(){return this.querySelectorAll(e)}}function ya(e){return function(){return ma(e.apply(this,arguments))}}function xa(e){typeof e=="function"?e=ya(e):e=Tr(e);for(var t=this._groups,n=t.length,o=[],r=[],i=0;i<n;++i)for(var s=t[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&(o.push(e.call(c,c.__data__,u,s)),r.push(c));return new pe(o,r)}function kr(e){return function(){return this.matches(e)}}function $r(e){return function(t){return t.matches(e)}}var wa=Array.prototype.find;function ba(e){return function(){return wa.call(this.children,e)}}function va(){return this.firstElementChild}function _a(e){return this.select(e==null?va:ba(typeof e=="function"?e:$r(e)))}var Sa=Array.prototype.filter;function Ea(){return Array.from(this.children)}function Na(e){return function(){return Sa.call(this.children,e)}}function Ca(e){return this.selectAll(e==null?Ea:Na(typeof e=="function"?e:$r(e)))}function Ma(e){typeof e!="function"&&(e=kr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new pe(o,this._parents)}function Rr(e){return new Array(e.length)}function Aa(){return new pe(this._enter||this._groups.map(Rr),this._parents)}function on(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}on.prototype={constructor:on,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function Ta(e){return function(){return e}}function ka(e,t,n,o,r,i){for(var s=0,a,c=t.length,u=i.length;s<u;++s)(a=t[s])?(a.__data__=i[s],o[s]=a):n[s]=new on(e,i[s]);for(;s<c;++s)(a=t[s])&&(r[s]=a)}function $a(e,t,n,o,r,i,s){var a,c,u=new Map,l=t.length,f=i.length,d=new Array(l),g;for(a=0;a<l;++a)(c=t[a])&&(d[a]=g=s.call(c,c.__data__,a,t)+"",u.has(g)?r[a]=c:u.set(g,c));for(a=0;a<f;++a)g=s.call(e,i[a],a,i)+"",(c=u.get(g))?(o[a]=c,c.__data__=i[a],u.delete(g)):n[a]=new on(e,i[a]);for(a=0;a<l;++a)(c=t[a])&&u.get(d[a])===c&&(r[a]=c)}function Ra(e){return e.__data__}function Ia(e,t){if(!arguments.length)return Array.from(this,Ra);var n=t?$a:ka,o=this._parents,r=this._groups;typeof e!="function"&&(e=Ta(e));for(var i=r.length,s=new Array(i),a=new Array(i),c=new Array(i),u=0;u<i;++u){var l=o[u],f=r[u],d=f.length,g=Da(e.call(l,l&&l.__data__,u,o)),y=g.length,m=a[u]=new Array(y),E=s[u]=new Array(y),p=c[u]=new Array(d);n(l,f,m,E,p,g,t);for(var _=0,N=0,b,M;_<y;++_)if(b=m[_]){for(_>=N&&(N=_+1);!(M=E[N])&&++N<y;);b._next=M||null}}return s=new pe(s,o),s._enter=a,s._exit=c,s}function Da(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Pa(){return new pe(this._exit||this._groups.map(Rr),this._parents)}function za(e,t,n){var o=this.enter(),r=this,i=this.exit();return typeof e=="function"?(o=e(o),o&&(o=o.selection())):o=o.append(e+""),t!=null&&(r=t(r),r&&(r=r.selection())),n==null?i.remove():n(i),o&&r?o.merge(r).order():r}function Oa(e){for(var t=e.selection?e.selection():e,n=this._groups,o=t._groups,r=n.length,i=o.length,s=Math.min(r,i),a=new Array(r),c=0;c<s;++c)for(var u=n[c],l=o[c],f=u.length,d=a[c]=new Array(f),g,y=0;y<f;++y)(g=u[y]||l[y])&&(d[y]=g);for(;c<r;++c)a[c]=n[c];return new pe(a,this._parents)}function Ha(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var o=e[t],r=o.length-1,i=o[r],s;--r>=0;)(s=o[r])&&(i&&s.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(s,i),i=s);return this}function La(e){e||(e=Ba);function t(f,d){return f&&d?e(f.__data__,d.__data__):!f-!d}for(var n=this._groups,o=n.length,r=new Array(o),i=0;i<o;++i){for(var s=n[i],a=s.length,c=r[i]=new Array(a),u,l=0;l<a;++l)(u=s[l])&&(c[l]=u);c.sort(t)}return new pe(r,this._parents).order()}function Ba(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function Va(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function Fa(){return Array.from(this)}function Xa(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length;r<i;++r){var s=o[r];if(s)return s}return null}function Ya(){let e=0;for(const t of this)++e;return e}function Wa(){return!this.node()}function Ua(e){for(var t=this._groups,n=0,o=t.length;n<o;++n)for(var r=t[n],i=0,s=r.length,a;i<s;++i)(a=r[i])&&e.call(a,a.__data__,i,r);return this}function Ga(e){return function(){this.removeAttribute(e)}}function Ka(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Za(e,t){return function(){this.setAttribute(e,t)}}function qa(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function ja(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function Ja(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function Qa(e,t){var n=pn(e);if(arguments.length<2){var o=this.node();return n.local?o.getAttributeNS(n.space,n.local):o.getAttribute(n)}return this.each((t==null?n.local?Ka:Ga:typeof t=="function"?n.local?Ja:ja:n.local?qa:Za)(n,t))}function Ir(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function ec(e){return function(){this.style.removeProperty(e)}}function tc(e,t,n){return function(){this.style.setProperty(e,t,n)}}function nc(e,t,n){return function(){var o=t.apply(this,arguments);o==null?this.style.removeProperty(e):this.style.setProperty(e,o,n)}}function oc(e,t,n){return arguments.length>1?this.each((t==null?ec:typeof t=="function"?nc:tc)(e,t,n==null?"":n)):pt(this.node(),e)}function pt(e,t){return e.style.getPropertyValue(t)||Ir(e).getComputedStyle(e,null).getPropertyValue(t)}function rc(e){return function(){delete this[e]}}function ic(e,t){return function(){this[e]=t}}function sc(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function ac(e,t){return arguments.length>1?this.each((t==null?rc:typeof t=="function"?sc:ic)(e,t)):this.node()[e]}function Dr(e){return e.trim().split(/^|\s+/)}function ro(e){return e.classList||new Pr(e)}function Pr(e){this._node=e,this._names=Dr(e.getAttribute("class")||"")}Pr.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function zr(e,t){for(var n=ro(e),o=-1,r=t.length;++o<r;)n.add(t[o])}function Or(e,t){for(var n=ro(e),o=-1,r=t.length;++o<r;)n.remove(t[o])}function cc(e){return function(){zr(this,e)}}function lc(e){return function(){Or(this,e)}}function uc(e,t){return function(){(t.apply(this,arguments)?zr:Or)(this,e)}}function fc(e,t){var n=Dr(e+"");if(arguments.length<2){for(var o=ro(this.node()),r=-1,i=n.length;++r<i;)if(!o.contains(n[r]))return!1;return!0}return this.each((typeof t=="function"?uc:t?cc:lc)(n,t))}function dc(){this.textContent=""}function hc(e){return function(){this.textContent=e}}function gc(e){return function(){var t=e.apply(this,arguments);this.textContent=t==null?"":t}}function mc(e){return arguments.length?this.each(e==null?dc:(typeof e=="function"?gc:hc)(e)):this.node().textContent}function pc(){this.innerHTML=""}function yc(e){return function(){this.innerHTML=e}}function xc(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t==null?"":t}}function wc(e){return arguments.length?this.each(e==null?pc:(typeof e=="function"?xc:yc)(e)):this.node().innerHTML}function bc(){this.nextSibling&&this.parentNode.appendChild(this)}function vc(){return this.each(bc)}function _c(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Sc(){return this.each(_c)}function Ec(e){var t=typeof e=="function"?e:Ar(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function Nc(){return null}function Cc(e,t){var n=typeof e=="function"?e:Ar(e),o=t==null?Nc:typeof t=="function"?t:oo(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),o.apply(this,arguments)||null)})}function Mc(){var e=this.parentNode;e&&e.removeChild(this)}function Ac(){return this.each(Mc)}function Tc(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function kc(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function $c(e){return this.select(e?kc:Tc)}function Rc(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ic(e){return function(t){e.call(this,t,this.__data__)}}function Dc(e){return e.trim().split(/^|\s+/).map(function(t){var n="",o=t.indexOf(".");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{type:t,name:n}})}function Pc(e){return function(){var t=this.__on;if(t){for(var n=0,o=-1,r=t.length,i;n<r;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++o]=i;++o?t.length=o:delete this.__on}}}function zc(e,t,n){return function(){var o=this.__on,r,i=Ic(t);if(o){for(var s=0,a=o.length;s<a;++s)if((r=o[s]).type===e.type&&r.name===e.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=i,r.options=n),r.value=t;return}}this.addEventListener(e.type,i,n),r={type:e.type,name:e.name,value:t,listener:i,options:n},o?o.push(r):this.__on=[r]}}function Oc(e,t,n){var o=Dc(e+""),r,i=o.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(r=0,l=a[c];r<i;++r)if((s=o[r]).type===l.type&&s.name===l.name)return l.value}return}for(a=t?zc:Pc,r=0;r<i;++r)this.each(a(o[r],t,n));return this}function Hr(e,t,n){var o=Ir(e),r=o.CustomEvent;typeof r=="function"?r=new r(t,n):(r=o.document.createEvent("Event"),n?(r.initEvent(t,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(t,!1,!1)),e.dispatchEvent(r)}function Hc(e,t){return function(){return Hr(this,e,t)}}function Lc(e,t){return function(){return Hr(this,e,t.apply(this,arguments))}}function Bc(e,t){return this.each((typeof t=="function"?Lc:Hc)(e,t))}function*Vc(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var o=e[t],r=0,i=o.length,s;r<i;++r)(s=o[r])&&(yield s)}var Lr=[null];function pe(e,t){this._groups=e,this._parents=t}function Ht(){return new pe([[document.documentElement]],Lr)}function Fc(){return this}pe.prototype=Ht.prototype={constructor:pe,select:ga,selectAll:xa,selectChild:_a,selectChildren:Ca,filter:Ma,data:Ia,enter:Aa,exit:Pa,join:za,merge:Oa,selection:Fc,order:Ha,sort:La,call:Va,nodes:Fa,node:Xa,size:Ya,empty:Wa,each:Ua,attr:Qa,style:oc,property:ac,classed:fc,text:mc,html:wc,raise:vc,lower:Sc,append:Ec,insert:Cc,remove:Ac,clone:$c,datum:Rc,on:Oc,dispatch:Bc,[Symbol.iterator]:Vc};function xe(e){return typeof e=="string"?new pe([[document.querySelector(e)]],[document.documentElement]):new pe([[e]],Lr)}function Xc(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ve(e,t){if(e=Xc(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var r=t.getBoundingClientRect();return[e.clientX-r.left-t.clientLeft,e.clientY-r.top-t.clientTop]}}return[e.pageX,e.pageY]}const Yc={passive:!1},kt={capture:!0,passive:!1};function $n(e){e.stopImmediatePropagation()}function dt(e){e.preventDefault(),e.stopImmediatePropagation()}function Br(e){var t=e.document.documentElement,n=xe(e).on("dragstart.drag",dt,kt);"onselectstart"in t?n.on("selectstart.drag",dt,kt):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Vr(e,t){var n=e.document.documentElement,o=xe(e).on("dragstart.drag",null);t&&(o.on("click.drag",dt,kt),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Ft=e=>()=>e;function Fn(e,{sourceEvent:t,subject:n,target:o,identifier:r,active:i,x:s,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:r,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}Fn.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Wc(e){return!e.ctrlKey&&!e.button}function Uc(){return this.parentNode}function Gc(e,t){return t==null?{x:e.x,y:e.y}:t}function Kc(){return navigator.maxTouchPoints||"ontouchstart"in this}function Zc(){var e=Wc,t=Uc,n=Gc,o=Kc,r={},i=mn("start","drag","end"),s=0,a,c,u,l,f=0;function d(b){b.on("mousedown.drag",g).filter(o).on("touchstart.drag",E).on("touchmove.drag",p,Yc).on("touchend.drag touchcancel.drag",_).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function g(b,M){if(!(l||!e.call(this,b,M))){var $=N(this,t.call(this,b,M),b,M,"mouse");$&&(xe(b.view).on("mousemove.drag",y,kt).on("mouseup.drag",m,kt),Br(b.view),$n(b),u=!1,a=b.clientX,c=b.clientY,$("start",b))}}function y(b){if(dt(b),!u){var M=b.clientX-a,$=b.clientY-c;u=M*M+$*$>f}r.mouse("drag",b)}function m(b){xe(b.view).on("mousemove.drag mouseup.drag",null),Vr(b.view,u),dt(b),r.mouse("end",b)}function E(b,M){if(e.call(this,b,M)){var $=b.changedTouches,O=t.call(this,b,M),B=$.length,R,z;for(R=0;R<B;++R)(z=N(this,O,b,M,$[R].identifier,$[R]))&&($n(b),z("start",b,$[R]))}}function p(b){var M=b.changedTouches,$=M.length,O,B;for(O=0;O<$;++O)(B=r[M[O].identifier])&&(dt(b),B("drag",b,M[O]))}function _(b){var M=b.changedTouches,$=M.length,O,B;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),O=0;O<$;++O)(B=r[M[O].identifier])&&($n(b),B("end",b,M[O]))}function N(b,M,$,O,B,R){var z=i.copy(),L=ve(R||$,M),H,k,h;if((h=n.call(b,new Fn("beforestart",{sourceEvent:$,target:d,identifier:B,active:s,x:L[0],y:L[1],dx:0,dy:0,dispatch:z}),O))!=null)return H=h.x-L[0]||0,k=h.y-L[1]||0,function S(x,A,I){var v=L,T;switch(x){case"start":r[B]=S,T=s++;break;case"end":delete r[B],--s;case"drag":L=ve(I||A,M),T=s;break}z.call(x,b,new Fn(x,{sourceEvent:A,subject:h,target:d,identifier:B,active:T,x:L[0]+H,y:L[1]+k,dx:L[0]-v[0],dy:L[1]-v[1],dispatch:z}),O)}}return d.filter=function(b){return arguments.length?(e=typeof b=="function"?b:Ft(!!b),d):e},d.container=function(b){return arguments.length?(t=typeof b=="function"?b:Ft(b),d):t},d.subject=function(b){return arguments.length?(n=typeof b=="function"?b:Ft(b),d):n},d.touchable=function(b){return arguments.length?(o=typeof b=="function"?b:Ft(!!b),d):o},d.on=function(){var b=i.on.apply(i,arguments);return b===i?d:b},d.clickDistance=function(b){return arguments.length?(f=(b=+b)*b,d):Math.sqrt(f)},d}function io(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Fr(e,t){var n=Object.create(e.prototype);for(var o in t)n[o]=t[o];return n}function Lt(){}var $t=.7,rn=1/$t,ht="\\s*([+-]?\\d+)\\s*",Rt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ce="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",qc=/^#([0-9a-f]{3,8})$/,jc=new RegExp(`^rgb\\(${ht},${ht},${ht}\\)$`),Jc=new RegExp(`^rgb\\(${Ce},${Ce},${Ce}\\)$`),Qc=new RegExp(`^rgba\\(${ht},${ht},${ht},${Rt}\\)$`),el=new RegExp(`^rgba\\(${Ce},${Ce},${Ce},${Rt}\\)$`),tl=new RegExp(`^hsl\\(${Rt},${Ce},${Ce}\\)$`),nl=new RegExp(`^hsla\\(${Rt},${Ce},${Ce},${Rt}\\)$`),Do={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};io(Lt,It,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:Po,formatHex:Po,formatHex8:ol,formatHsl:rl,formatRgb:zo,toString:zo});function Po(){return this.rgb().formatHex()}function ol(){return this.rgb().formatHex8()}function rl(){return Xr(this).formatHsl()}function zo(){return this.rgb().formatRgb()}function It(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=qc.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?Oo(t):n===3?new me(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Xt(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Xt(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=jc.exec(e))?new me(t[1],t[2],t[3],1):(t=Jc.exec(e))?new me(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=Qc.exec(e))?Xt(t[1],t[2],t[3],t[4]):(t=el.exec(e))?Xt(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=tl.exec(e))?Bo(t[1],t[2]/100,t[3]/100,1):(t=nl.exec(e))?Bo(t[1],t[2]/100,t[3]/100,t[4]):Do.hasOwnProperty(e)?Oo(Do[e]):e==="transparent"?new me(NaN,NaN,NaN,0):null}function Oo(e){return new me(e>>16&255,e>>8&255,e&255,1)}function Xt(e,t,n,o){return o<=0&&(e=t=n=NaN),new me(e,t,n,o)}function il(e){return e instanceof Lt||(e=It(e)),e?(e=e.rgb(),new me(e.r,e.g,e.b,e.opacity)):new me}function Xn(e,t,n,o){return arguments.length===1?il(e):new me(e,t,n,o==null?1:o)}function me(e,t,n,o){this.r=+e,this.g=+t,this.b=+n,this.opacity=+o}io(me,Xn,Fr(Lt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new me(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?$t:Math.pow($t,e),new me(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new me(Je(this.r),Je(this.g),Je(this.b),sn(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ho,formatHex:Ho,formatHex8:sl,formatRgb:Lo,toString:Lo}));function Ho(){return`#${qe(this.r)}${qe(this.g)}${qe(this.b)}`}function sl(){return`#${qe(this.r)}${qe(this.g)}${qe(this.b)}${qe((isNaN(this.opacity)?1:this.opacity)*255)}`}function Lo(){const e=sn(this.opacity);return`${e===1?"rgb(":"rgba("}${Je(this.r)}, ${Je(this.g)}, ${Je(this.b)}${e===1?")":`, ${e})`}`}function sn(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Je(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function qe(e){return e=Je(e),(e<16?"0":"")+e.toString(16)}function Bo(e,t,n,o){return o<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new _e(e,t,n,o)}function Xr(e){if(e instanceof _e)return new _e(e.h,e.s,e.l,e.opacity);if(e instanceof Lt||(e=It(e)),!e)return new _e;if(e instanceof _e)return e;e=e.rgb();var t=e.r/255,n=e.g/255,o=e.b/255,r=Math.min(t,n,o),i=Math.max(t,n,o),s=NaN,a=i-r,c=(i+r)/2;return a?(t===i?s=(n-o)/a+(n<o)*6:n===i?s=(o-t)/a+2:s=(t-n)/a+4,a/=c<.5?i+r:2-i-r,s*=60):a=c>0&&c<1?0:s,new _e(s,a,c,e.opacity)}function al(e,t,n,o){return arguments.length===1?Xr(e):new _e(e,t,n,o==null?1:o)}function _e(e,t,n,o){this.h=+e,this.s=+t,this.l=+n,this.opacity=+o}io(_e,al,Fr(Lt,{brighter(e){return e=e==null?rn:Math.pow(rn,e),new _e(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?$t:Math.pow($t,e),new _e(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,o=n+(n<.5?n:1-n)*t,r=2*n-o;return new me(Rn(e>=240?e-240:e+120,r,o),Rn(e,r,o),Rn(e<120?e+240:e-120,r,o),this.opacity)},clamp(){return new _e(Vo(this.h),Yt(this.s),Yt(this.l),sn(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sn(this.opacity);return`${e===1?"hsl(":"hsla("}${Vo(this.h)}, ${Yt(this.s)*100}%, ${Yt(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Vo(e){return e=(e||0)%360,e<0?e+360:e}function Yt(e){return Math.max(0,Math.min(1,e||0))}function Rn(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Yr=e=>()=>e;function cl(e,t){return function(n){return e+n*t}}function ll(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(o){return Math.pow(e+o*t,n)}}function ul(e){return(e=+e)==1?Wr:function(t,n){return n-t?ll(t,n,e):Yr(isNaN(t)?n:t)}}function Wr(e,t){var n=t-e;return n?cl(e,n):Yr(isNaN(e)?t:e)}const Fo=function e(t){var n=ul(t);function o(r,i){var s=n((r=Xn(r)).r,(i=Xn(i)).r),a=n(r.g,i.g),c=n(r.b,i.b),u=Wr(r.opacity,i.opacity);return function(l){return r.r=s(l),r.g=a(l),r.b=c(l),r.opacity=u(l),r+""}}return o.gamma=e,o}(1);function He(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var Yn=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,In=new RegExp(Yn.source,"g");function fl(e){return function(){return e}}function dl(e){return function(t){return e(t)+""}}function hl(e,t){var n=Yn.lastIndex=In.lastIndex=0,o,r,i,s=-1,a=[],c=[];for(e=e+"",t=t+"";(o=Yn.exec(e))&&(r=In.exec(t));)(i=r.index)>n&&(i=t.slice(n,i),a[s]?a[s]+=i:a[++s]=i),(o=o[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,c.push({i:s,x:He(o,r)})),n=In.lastIndex;return n<t.length&&(i=t.slice(n),a[s]?a[s]+=i:a[++s]=i),a.length<2?c[0]?dl(c[0].x):fl(t):(t=c.length,function(u){for(var l=0,f;l<t;++l)a[(f=c[l]).i]=f.x(u);return a.join("")})}var Xo=180/Math.PI,Wn={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ur(e,t,n,o,r,i){var s,a,c;return(s=Math.sqrt(e*e+t*t))&&(e/=s,t/=s),(c=e*n+t*o)&&(n-=e*c,o-=t*c),(a=Math.sqrt(n*n+o*o))&&(n/=a,o/=a,c/=a),e*o<t*n&&(e=-e,t=-t,c=-c,s=-s),{translateX:r,translateY:i,rotate:Math.atan2(t,e)*Xo,skewX:Math.atan(c)*Xo,scaleX:s,scaleY:a}}var Wt;function gl(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Wn:Ur(t.a,t.b,t.c,t.d,t.e,t.f)}function ml(e){return e==null||(Wt||(Wt=document.createElementNS("http://www.w3.org/2000/svg","g")),Wt.setAttribute("transform",e),!(e=Wt.transform.baseVal.consolidate()))?Wn:(e=e.matrix,Ur(e.a,e.b,e.c,e.d,e.e,e.f))}function Gr(e,t,n,o){function r(u){return u.length?u.pop()+" ":""}function i(u,l,f,d,g,y){if(u!==f||l!==d){var m=g.push("translate(",null,t,null,n);y.push({i:m-4,x:He(u,f)},{i:m-2,x:He(l,d)})}else(f||d)&&g.push("translate("+f+t+d+n)}function s(u,l,f,d){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),d.push({i:f.push(r(f)+"rotate(",null,o)-2,x:He(u,l)})):l&&f.push(r(f)+"rotate("+l+o)}function a(u,l,f,d){u!==l?d.push({i:f.push(r(f)+"skewX(",null,o)-2,x:He(u,l)}):l&&f.push(r(f)+"skewX("+l+o)}function c(u,l,f,d,g,y){if(u!==f||l!==d){var m=g.push(r(g)+"scale(",null,",",null,")");y.push({i:m-4,x:He(u,f)},{i:m-2,x:He(l,d)})}else(f!==1||d!==1)&&g.push(r(g)+"scale("+f+","+d+")")}return function(u,l){var f=[],d=[];return u=e(u),l=e(l),i(u.translateX,u.translateY,l.translateX,l.translateY,f,d),s(u.rotate,l.rotate,f,d),a(u.skewX,l.skewX,f,d),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,f,d),u=l=null,function(g){for(var y=-1,m=d.length,E;++y<m;)f[(E=d[y]).i]=E.x(g);return f.join("")}}}var pl=Gr(gl,"px, ","px)","deg)"),yl=Gr(ml,", ",")",")"),xl=1e-12;function Yo(e){return((e=Math.exp(e))+1/e)/2}function wl(e){return((e=Math.exp(e))-1/e)/2}function bl(e){return((e=Math.exp(2*e))-1)/(e+1)}const vl=function e(t,n,o){function r(i,s){var a=i[0],c=i[1],u=i[2],l=s[0],f=s[1],d=s[2],g=l-a,y=f-c,m=g*g+y*y,E,p;if(m<xl)p=Math.log(d/u)/t,E=function(O){return[a+O*g,c+O*y,u*Math.exp(t*O*p)]};else{var _=Math.sqrt(m),N=(d*d-u*u+o*m)/(2*u*n*_),b=(d*d-u*u-o*m)/(2*d*n*_),M=Math.log(Math.sqrt(N*N+1)-N),$=Math.log(Math.sqrt(b*b+1)-b);p=($-M)/t,E=function(O){var B=O*p,R=Yo(M),z=u/(n*_)*(R*bl(t*B+M)-wl(M));return[a+z*g,c+z*y,u*R/Yo(t*B+M)]}}return E.duration=p*1e3*t/Math.SQRT2,E}return r.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},r}(Math.SQRT2,2,4);var yt=0,Mt=0,_t=0,Kr=1e3,an,At,cn=0,et=0,yn=0,Dt=typeof performance=="object"&&performance.now?performance:Date,Zr=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function so(){return et||(Zr(_l),et=Dt.now()+yn)}function _l(){et=0}function ln(){this._call=this._time=this._next=null}ln.prototype=qr.prototype={constructor:ln,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?so():+n)+(t==null?0:+t),!this._next&&At!==this&&(At?At._next=this:an=this,At=this),this._call=e,this._time=n,Un()},stop:function(){this._call&&(this._call=null,this._time=1/0,Un())}};function qr(e,t,n){var o=new ln;return o.restart(e,t,n),o}function Sl(){so(),++yt;for(var e=an,t;e;)(t=et-e._time)>=0&&e._call.call(void 0,t),e=e._next;--yt}function Wo(){et=(cn=Dt.now())+yn,yt=Mt=0;try{Sl()}finally{yt=0,Nl(),et=0}}function El(){var e=Dt.now(),t=e-cn;t>Kr&&(yn-=t,cn=e)}function Nl(){for(var e,t=an,n,o=1/0;t;)t._call?(o>t._time&&(o=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:an=n);At=e,Un(o)}function Un(e){if(!yt){Mt&&(Mt=clearTimeout(Mt));var t=e-et;t>24?(e<1/0&&(Mt=setTimeout(Wo,e-Dt.now()-yn)),_t&&(_t=clearInterval(_t))):(_t||(cn=Dt.now(),_t=setInterval(El,Kr)),yt=1,Zr(Wo))}}function Uo(e,t,n){var o=new ln;return t=t==null?0:+t,o.restart(r=>{o.stop(),e(r+t)},t,n),o}var Cl=mn("start","end","cancel","interrupt"),Ml=[],jr=0,Go=1,Gn=2,Qt=3,Ko=4,Kn=5,en=6;function xn(e,t,n,o,r,i){var s=e.__transition;if(!s)e.__transition={};else if(n in s)return;Al(e,n,{name:t,index:o,group:r,on:Cl,tween:Ml,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:jr})}function ao(e,t){var n=Ee(e,t);if(n.state>jr)throw new Error("too late; already scheduled");return n}function Me(e,t){var n=Ee(e,t);if(n.state>Qt)throw new Error("too late; already running");return n}function Ee(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Al(e,t,n){var o=e.__transition,r;o[t]=n,n.timer=qr(i,0,n.time);function i(u){n.state=Go,n.timer.restart(s,n.delay,n.time),n.delay<=u&&s(u-n.delay)}function s(u){var l,f,d,g;if(n.state!==Go)return c();for(l in o)if(g=o[l],g.name===n.name){if(g.state===Qt)return Uo(s);g.state===Ko?(g.state=en,g.timer.stop(),g.on.call("interrupt",e,e.__data__,g.index,g.group),delete o[l]):+l<t&&(g.state=en,g.timer.stop(),g.on.call("cancel",e,e.__data__,g.index,g.group),delete o[l])}if(Uo(function(){n.state===Qt&&(n.state=Ko,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Gn,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Gn){for(n.state=Qt,r=new Array(d=n.tween.length),l=0,f=-1;l<d;++l)(g=n.tween[l].value.call(e,e.__data__,n.index,n.group))&&(r[++f]=g);r.length=f+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Kn,1),f=-1,d=r.length;++f<d;)r[f].call(e,l);n.state===Kn&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=en,n.timer.stop(),delete o[t];for(var u in o)return;delete e.__transition}}function tn(e,t){var n=e.__transition,o,r,i=!0,s;if(n){t=t==null?null:t+"";for(s in n){if((o=n[s]).name!==t){i=!1;continue}r=o.state>Gn&&o.state<Kn,o.state=en,o.timer.stop(),o.on.call(r?"interrupt":"cancel",e,e.__data__,o.index,o.group),delete n[s]}i&&delete e.__transition}}function Tl(e){return this.each(function(){tn(this,e)})}function kl(e,t){var n,o;return function(){var r=Me(this,e),i=r.tween;if(i!==n){o=n=i;for(var s=0,a=o.length;s<a;++s)if(o[s].name===t){o=o.slice(),o.splice(s,1);break}}r.tween=o}}function $l(e,t,n){var o,r;if(typeof n!="function")throw new Error;return function(){var i=Me(this,e),s=i.tween;if(s!==o){r=(o=s).slice();for(var a={name:t,value:n},c=0,u=r.length;c<u;++c)if(r[c].name===t){r[c]=a;break}c===u&&r.push(a)}i.tween=r}}function Rl(e,t){var n=this._id;if(e+="",arguments.length<2){for(var o=Ee(this.node(),n).tween,r=0,i=o.length,s;r<i;++r)if((s=o[r]).name===e)return s.value;return null}return this.each((t==null?kl:$l)(n,e,t))}function co(e,t,n){var o=e._id;return e.each(function(){var r=Me(this,o);(r.value||(r.value={}))[t]=n.apply(this,arguments)}),function(r){return Ee(r,o).value[t]}}function Jr(e,t){var n;return(typeof t=="number"?He:t instanceof It?Fo:(n=It(t))?(t=n,Fo):hl)(e,t)}function Il(e){return function(){this.removeAttribute(e)}}function Dl(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Pl(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttribute(e);return s===r?null:s===o?i:i=t(o=s,n)}}function zl(e,t,n){var o,r=n+"",i;return function(){var s=this.getAttributeNS(e.space,e.local);return s===r?null:s===o?i:i=t(o=s,n)}}function Ol(e,t,n){var o,r,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttribute(e):(s=this.getAttribute(e),c=a+"",s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a)))}}function Hl(e,t,n){var o,r,i;return function(){var s,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(s=this.getAttributeNS(e.space,e.local),c=a+"",s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a)))}}function Ll(e,t){var n=pn(e),o=n==="transform"?yl:Jr;return this.attrTween(e,typeof t=="function"?(n.local?Hl:Ol)(n,o,co(this,"attr."+e,t)):t==null?(n.local?Dl:Il)(n):(n.local?zl:Pl)(n,o,t))}function Bl(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Vl(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Fl(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Vl(e,i)),n}return r._value=t,r}function Xl(e,t){var n,o;function r(){var i=t.apply(this,arguments);return i!==o&&(n=(o=i)&&Bl(e,i)),n}return r._value=t,r}function Yl(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var o=pn(e);return this.tween(n,(o.local?Fl:Xl)(o,t))}function Wl(e,t){return function(){ao(this,e).delay=+t.apply(this,arguments)}}function Ul(e,t){return t=+t,function(){ao(this,e).delay=t}}function Gl(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Wl:Ul)(t,e)):Ee(this.node(),t).delay}function Kl(e,t){return function(){Me(this,e).duration=+t.apply(this,arguments)}}function Zl(e,t){return t=+t,function(){Me(this,e).duration=t}}function ql(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Kl:Zl)(t,e)):Ee(this.node(),t).duration}function jl(e,t){if(typeof t!="function")throw new Error;return function(){Me(this,e).ease=t}}function Jl(e){var t=this._id;return arguments.length?this.each(jl(t,e)):Ee(this.node(),t).ease}function Ql(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Me(this,e).ease=n}}function eu(e){if(typeof e!="function")throw new Error;return this.each(Ql(this._id,e))}function tu(e){typeof e!="function"&&(e=kr(e));for(var t=this._groups,n=t.length,o=new Array(n),r=0;r<n;++r)for(var i=t[r],s=i.length,a=o[r]=[],c,u=0;u<s;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&a.push(c);return new De(o,this._parents,this._name,this._id)}function nu(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,o=t.length,r=n.length,i=Math.min(o,r),s=new Array(o),a=0;a<i;++a)for(var c=t[a],u=n[a],l=c.length,f=s[a]=new Array(l),d,g=0;g<l;++g)(d=c[g]||u[g])&&(f[g]=d);for(;a<o;++a)s[a]=t[a];return new De(s,this._parents,this._name,this._id)}function ou(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function ru(e,t,n){var o,r,i=ou(t)?ao:Me;return function(){var s=i(this,e),a=s.on;a!==o&&(r=(o=a).copy()).on(t,n),s.on=r}}function iu(e,t){var n=this._id;return arguments.length<2?Ee(this.node(),n).on.on(e):this.each(ru(n,e,t))}function su(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function au(){return this.on("end.remove",su(this._id))}function cu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=oo(e));for(var o=this._groups,r=o.length,i=new Array(r),s=0;s<r;++s)for(var a=o[s],c=a.length,u=i[s]=new Array(c),l,f,d=0;d<c;++d)(l=a[d])&&(f=e.call(l,l.__data__,d,a))&&("__data__"in l&&(f.__data__=l.__data__),u[d]=f,xn(u[d],t,n,d,u,Ee(l,n)));return new De(i,this._parents,t,n)}function lu(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Tr(e));for(var o=this._groups,r=o.length,i=[],s=[],a=0;a<r;++a)for(var c=o[a],u=c.length,l,f=0;f<u;++f)if(l=c[f]){for(var d=e.call(l,l.__data__,f,c),g,y=Ee(l,n),m=0,E=d.length;m<E;++m)(g=d[m])&&xn(g,t,n,m,d,y);i.push(d),s.push(l)}return new De(i,s,t,n)}var uu=Ht.prototype.constructor;function fu(){return new uu(this._groups,this._parents)}function du(e,t){var n,o,r;return function(){var i=pt(this,e),s=(this.style.removeProperty(e),pt(this,e));return i===s?null:i===n&&s===o?r:r=t(n=i,o=s)}}function Qr(e){return function(){this.style.removeProperty(e)}}function hu(e,t,n){var o,r=n+"",i;return function(){var s=pt(this,e);return s===r?null:s===o?i:i=t(o=s,n)}}function gu(e,t,n){var o,r,i;return function(){var s=pt(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),pt(this,e))),s===c?null:s===o&&c===r?i:(r=c,i=t(o=s,a))}}function mu(e,t){var n,o,r,i="style."+t,s="end."+i,a;return function(){var c=Me(this,e),u=c.on,l=c.value[i]==null?a||(a=Qr(t)):void 0;(u!==n||r!==l)&&(o=(n=u).copy()).on(s,r=l),c.on=o}}function pu(e,t,n){var o=(e+="")=="transform"?pl:Jr;return t==null?this.styleTween(e,du(e,o)).on("end.style."+e,Qr(e)):typeof t=="function"?this.styleTween(e,gu(e,o,co(this,"style."+e,t))).each(mu(this._id,e)):this.styleTween(e,hu(e,o,t),n).on("end.style."+e,null)}function yu(e,t,n){return function(o){this.style.setProperty(e,t.call(this,o),n)}}function xu(e,t,n){var o,r;function i(){var s=t.apply(this,arguments);return s!==r&&(o=(r=s)&&yu(e,s,n)),o}return i._value=t,i}function wu(e,t,n){var o="style."+(e+="");if(arguments.length<2)return(o=this.tween(o))&&o._value;if(t==null)return this.tween(o,null);if(typeof t!="function")throw new Error;return this.tween(o,xu(e,t,n==null?"":n))}function bu(e){return function(){this.textContent=e}}function vu(e){return function(){var t=e(this);this.textContent=t==null?"":t}}function _u(e){return this.tween("text",typeof e=="function"?vu(co(this,"text",e)):bu(e==null?"":e+""))}function Su(e){return function(t){this.textContent=e.call(this,t)}}function Eu(e){var t,n;function o(){var r=e.apply(this,arguments);return r!==n&&(t=(n=r)&&Su(r)),t}return o._value=e,o}function Nu(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Eu(e))}function Cu(){for(var e=this._name,t=this._id,n=ei(),o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,c,u=0;u<a;++u)if(c=s[u]){var l=Ee(c,t);xn(c,e,n,u,s,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new De(o,this._parents,e,n)}function Mu(){var e,t,n=this,o=n._id,r=n.size();return new Promise(function(i,s){var a={value:s},c={value:function(){--r===0&&i()}};n.each(function(){var u=Me(this,o),l=u.on;l!==e&&(t=(e=l).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),u.on=t}),r===0&&i()})}var Au=0;function De(e,t,n,o){this._groups=e,this._parents=t,this._name=n,this._id=o}function ei(){return++Au}var $e=Ht.prototype;De.prototype={constructor:De,select:cu,selectAll:lu,selectChild:$e.selectChild,selectChildren:$e.selectChildren,filter:tu,merge:nu,selection:fu,transition:Cu,call:$e.call,nodes:$e.nodes,node:$e.node,size:$e.size,empty:$e.empty,each:$e.each,on:iu,attr:Ll,attrTween:Yl,style:pu,styleTween:wu,text:_u,textTween:Nu,remove:au,tween:Rl,delay:Gl,duration:ql,ease:Jl,easeVarying:eu,end:Mu,[Symbol.iterator]:$e[Symbol.iterator]};function Tu(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var ku={time:null,delay:0,duration:250,ease:Tu};function $u(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Ru(e){var t,n;e instanceof De?(t=e._id,e=e._name):(t=ei(),(n=ku).time=so(),e=e==null?null:e+"");for(var o=this._groups,r=o.length,i=0;i<r;++i)for(var s=o[i],a=s.length,c,u=0;u<a;++u)(c=s[u])&&xn(c,e,t,u,s,n||$u(c,t));return new De(o,this._parents,e,t)}Ht.prototype.interrupt=Tl;Ht.prototype.transition=Ru;const Ut=e=>()=>e;function Iu(e,{sourceEvent:t,target:n,transform:o,dispatch:r}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:r}})}function Re(e,t,n){this.k=e,this.x=t,this.y=n}Re.prototype={constructor:Re,scale:function(e){return e===1?this:new Re(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Re(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Ie=new Re(1,0,0);Re.prototype;function Dn(e){e.stopImmediatePropagation()}function St(e){e.preventDefault(),e.stopImmediatePropagation()}function Du(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Pu(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Zo(){return this.__zoom||Ie}function zu(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Ou(){return navigator.maxTouchPoints||"ontouchstart"in this}function Hu(e,t,n){var o=e.invertX(t[0][0])-n[0][0],r=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(r>o?(o+r)/2:Math.min(0,o)||Math.max(0,r),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function ti(){var e=Du,t=Pu,n=Hu,o=zu,r=Ou,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=vl,u=mn("start","zoom","end"),l,f,d,g=500,y=150,m=0,E=10;function p(h){h.property("__zoom",Zo).on("wheel.zoom",B,{passive:!1}).on("mousedown.zoom",R).on("dblclick.zoom",z).filter(r).on("touchstart.zoom",L).on("touchmove.zoom",H).on("touchend.zoom touchcancel.zoom",k).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}p.transform=function(h,S,x,A){var I=h.selection?h.selection():h;I.property("__zoom",Zo),h!==I?M(h,S,x,A):I.interrupt().each(function(){$(this,arguments).event(A).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},p.scaleBy=function(h,S,x,A){p.scaleTo(h,function(){var I=this.__zoom.k,v=typeof S=="function"?S.apply(this,arguments):S;return I*v},x,A)},p.scaleTo=function(h,S,x,A){p.transform(h,function(){var I=t.apply(this,arguments),v=this.__zoom,T=x==null?b(I):typeof x=="function"?x.apply(this,arguments):x,P=v.invert(T),D=typeof S=="function"?S.apply(this,arguments):S;return n(N(_(v,D),T,P),I,s)},x,A)},p.translateBy=function(h,S,x,A){p.transform(h,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof x=="function"?x.apply(this,arguments):x),t.apply(this,arguments),s)},null,A)},p.translateTo=function(h,S,x,A,I){p.transform(h,function(){var v=t.apply(this,arguments),T=this.__zoom,P=A==null?b(v):typeof A=="function"?A.apply(this,arguments):A;return n(Ie.translate(P[0],P[1]).scale(T.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof x=="function"?-x.apply(this,arguments):-x),v,s)},A,I)};function _(h,S){return S=Math.max(i[0],Math.min(i[1],S)),S===h.k?h:new Re(S,h.x,h.y)}function N(h,S,x){var A=S[0]-x[0]*h.k,I=S[1]-x[1]*h.k;return A===h.x&&I===h.y?h:new Re(h.k,A,I)}function b(h){return[(+h[0][0]+ +h[1][0])/2,(+h[0][1]+ +h[1][1])/2]}function M(h,S,x,A){h.on("start.zoom",function(){$(this,arguments).event(A).start()}).on("interrupt.zoom end.zoom",function(){$(this,arguments).event(A).end()}).tween("zoom",function(){var I=this,v=arguments,T=$(I,v).event(A),P=t.apply(I,v),D=x==null?b(P):typeof x=="function"?x.apply(I,v):x,V=Math.max(P[1][0]-P[0][0],P[1][1]-P[0][1]),F=I.__zoom,U=typeof S=="function"?S.apply(I,v):S,K=c(F.invert(D).concat(V/F.k),U.invert(D).concat(V/U.k));return function(G){if(G===1)G=U;else{var j=K(G),ee=V/j[2];G=new Re(ee,D[0]-j[0]*ee,D[1]-j[1]*ee)}T.zoom(null,G)}})}function $(h,S,x){return!x&&h.__zooming||new O(h,S)}function O(h,S){this.that=h,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(h,S),this.taps=0}O.prototype={event:function(h){return h&&(this.sourceEvent=h),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(h,S){return this.mouse&&h!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&h!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&h!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(h){var S=xe(this.that).datum();u.call(h,this.that,new Iu(h,{sourceEvent:this.sourceEvent,target:p,type:h,transform:this.that.__zoom,dispatch:u}),S)}};function B(h,...S){if(!e.apply(this,arguments))return;var x=$(this,S).event(h),A=this.__zoom,I=Math.max(i[0],Math.min(i[1],A.k*Math.pow(2,o.apply(this,arguments)))),v=ve(h);if(x.wheel)(x.mouse[0][0]!==v[0]||x.mouse[0][1]!==v[1])&&(x.mouse[1]=A.invert(x.mouse[0]=v)),clearTimeout(x.wheel);else{if(A.k===I)return;x.mouse=[v,A.invert(v)],tn(this),x.start()}St(h),x.wheel=setTimeout(T,y),x.zoom("mouse",n(N(_(A,I),x.mouse[0],x.mouse[1]),x.extent,s));function T(){x.wheel=null,x.end()}}function R(h,...S){if(d||!e.apply(this,arguments))return;var x=h.currentTarget,A=$(this,S,!0).event(h),I=xe(h.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",V,!0),v=ve(h,x),T=h.clientX,P=h.clientY;Br(h.view),Dn(h),A.mouse=[v,this.__zoom.invert(v)],tn(this),A.start();function D(F){if(St(F),!A.moved){var U=F.clientX-T,K=F.clientY-P;A.moved=U*U+K*K>m}A.event(F).zoom("mouse",n(N(A.that.__zoom,A.mouse[0]=ve(F,x),A.mouse[1]),A.extent,s))}function V(F){I.on("mousemove.zoom mouseup.zoom",null),Vr(F.view,A.moved),St(F),A.event(F).end()}}function z(h,...S){if(e.apply(this,arguments)){var x=this.__zoom,A=ve(h.changedTouches?h.changedTouches[0]:h,this),I=x.invert(A),v=x.k*(h.shiftKey?.5:2),T=n(N(_(x,v),A,I),t.apply(this,S),s);St(h),a>0?xe(this).transition().duration(a).call(M,T,A,h):xe(this).call(p.transform,T,A,h)}}function L(h,...S){if(e.apply(this,arguments)){var x=h.touches,A=x.length,I=$(this,S,h.changedTouches.length===A).event(h),v,T,P,D;for(Dn(h),T=0;T<A;++T)P=x[T],D=ve(P,this),D=[D,this.__zoom.invert(D),P.identifier],I.touch0?!I.touch1&&I.touch0[2]!==D[2]&&(I.touch1=D,I.taps=0):(I.touch0=D,v=!0,I.taps=1+!!l);l&&(l=clearTimeout(l)),v&&(I.taps<2&&(f=D[0],l=setTimeout(function(){l=null},g)),tn(this),I.start())}}function H(h,...S){if(this.__zooming){var x=$(this,S).event(h),A=h.changedTouches,I=A.length,v,T,P,D;for(St(h),v=0;v<I;++v)T=A[v],P=ve(T,this),x.touch0&&x.touch0[2]===T.identifier?x.touch0[0]=P:x.touch1&&x.touch1[2]===T.identifier&&(x.touch1[0]=P);if(T=x.that.__zoom,x.touch1){var V=x.touch0[0],F=x.touch0[1],U=x.touch1[0],K=x.touch1[1],G=(G=U[0]-V[0])*G+(G=U[1]-V[1])*G,j=(j=K[0]-F[0])*j+(j=K[1]-F[1])*j;T=_(T,Math.sqrt(G/j)),P=[(V[0]+U[0])/2,(V[1]+U[1])/2],D=[(F[0]+K[0])/2,(F[1]+K[1])/2]}else if(x.touch0)P=x.touch0[0],D=x.touch0[1];else return;x.zoom("touch",n(N(T,P,D),x.extent,s))}}function k(h,...S){if(this.__zooming){var x=$(this,S).event(h),A=h.changedTouches,I=A.length,v,T;for(Dn(h),d&&clearTimeout(d),d=setTimeout(function(){d=null},g),v=0;v<I;++v)T=A[v],x.touch0&&x.touch0[2]===T.identifier?delete x.touch0:x.touch1&&x.touch1[2]===T.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(T=ve(T,this),Math.hypot(f[0]-T[0],f[1]-T[1])<E)){var P=xe(this).on("dblclick.zoom");P&&P.apply(this,arguments)}}}return p.wheelDelta=function(h){return arguments.length?(o=typeof h=="function"?h:Ut(+h),p):o},p.filter=function(h){return arguments.length?(e=typeof h=="function"?h:Ut(!!h),p):e},p.touchable=function(h){return arguments.length?(r=typeof h=="function"?h:Ut(!!h),p):r},p.extent=function(h){return arguments.length?(t=typeof h=="function"?h:Ut([[+h[0][0],+h[0][1]],[+h[1][0],+h[1][1]]]),p):t},p.scaleExtent=function(h){return arguments.length?(i[0]=+h[0],i[1]=+h[1],p):[i[0],i[1]]},p.translateExtent=function(h){return arguments.length?(s[0][0]=+h[0][0],s[1][0]=+h[1][0],s[0][1]=+h[0][1],s[1][1]=+h[1][1],p):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},p.constrain=function(h){return arguments.length?(n=h,p):n},p.duration=function(h){return arguments.length?(a=+h,p):a},p.interpolate=function(h){return arguments.length?(c=h,p):c},p.on=function(){var h=u.on.apply(u,arguments);return h===u?p:h},p.clickDistance=function(h){return arguments.length?(m=(h=+h)*h,p):Math.sqrt(m)},p.tapDistance=function(h){return arguments.length?(E=+h,p):E},p}const wn=w.createContext(null),Lu=wn.Provider,Pe={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},ni=Pe.error001();function ne(e,t){const n=w.useContext(wn);if(n===null)throw new Error(ni);return Mr(n,e,t)}const ce=()=>{const e=w.useContext(wn);if(e===null)throw new Error(ni);return w.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Bu=e=>e.userSelectionActive?"none":"all";function lo(i){var s=i,{position:e,children:t,className:n,style:o}=s,r=st(s,["position","children","className","style"]);const a=ne(Bu),c=`${e}`.split("-");return C.createElement("div",X({className:de(["react-flow__panel",n,...c]),style:oe(X({},o),{pointerEvents:a})},r),t)}function Vu({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:C.createElement(lo,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},C.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Fu=f=>{var d=f,{x:e,y:t,label:n,labelStyle:o={},labelShowBg:r=!0,labelBgStyle:i={},labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:u}=d,l=st(d,["x","y","label","labelStyle","labelShowBg","labelBgStyle","labelBgPadding","labelBgBorderRadius","children","className"]);const g=w.useRef(null),[y,m]=w.useState({x:0,y:0,width:0,height:0}),E=de(["react-flow__edge-textwrapper",u]);return w.useEffect(()=>{if(g.current){const p=g.current.getBBox();m({x:p.x,y:p.y,width:p.width,height:p.height})}},[n]),typeof n=="undefined"||!n?null:C.createElement("g",X({transform:`translate(${e-y.width/2} ${t-y.height/2})`,className:E,visibility:y.width?"visible":"hidden"},l),r&&C.createElement("rect",{width:y.width+2*s[0],x:-s[0],y:-s[1],height:y.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),C.createElement("text",{className:"react-flow__edge-text",y:y.height/2,dy:"0.3em",ref:g,style:o},n),c)};var Xu=w.memo(Fu);const uo=e=>({width:e.offsetWidth,height:e.offsetHeight}),xt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),fo=(e={x:0,y:0},t)=>({x:xt(e.x,t[0][0],t[1][0]),y:xt(e.y,t[0][1],t[1][1])}),qo=(e,t,n)=>e<t?xt(Math.abs(e-t),1,50)/50:e>n?-xt(Math.abs(e-n),1,50)/50:0,oi=(e,t)=>{const n=qo(e.x,35,t.width-35)*20,o=qo(e.y,35,t.height-35)*20;return[n,o]},ri=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},ii=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Pt=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),si=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),jo=e=>oe(X({},e.positionAbsolute||{x:0,y:0}),{width:e.width||0,height:e.height||0}),Yu=(e,t)=>si(ii(Pt(e),Pt(t))),Zn=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Wu=e=>we(e.width)&&we(e.height)&&we(e.x)&&we(e.y),we=e=>!isNaN(e)&&isFinite(e),ie=Symbol.for("internals"),ai=["Enter"," ","Escape"],Uu=(e,t)=>{},Gu=e=>"nativeEvent"in e;function qn(e){var r,i;const t=Gu(e)?e.nativeEvent:e,n=((i=(r=t.composedPath)==null?void 0:r.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const ci=e=>"clientX"in e,Ve=(e,t)=>{var i,s,a,c;const n=ci(e),o=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,r=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:o-((a=t==null?void 0:t.left)!=null?a:0),y:r-((c=t==null?void 0:t.top)!=null?c:0)}},un=()=>{var e;return typeof navigator!="undefined"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},Bt=({id:e,path:t,labelX:n,labelY:o,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:g=20})=>C.createElement(C.Fragment,null,C.createElement("path",{id:e,style:l,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:d}),g&&C.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:g,className:"react-flow__edge-interaction"}),r&&we(n)&&we(o)?C.createElement(Xu,{x:n,y:o,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u}):null);Bt.displayName="BaseEdge";function Et(e,t,n){return n===void 0?n:o=>{const r=t().edges.find(i=>i.id===e);r&&n(o,X({},r))}}function li({sourceX:e,sourceY:t,targetX:n,targetY:o}){const r=Math.abs(n-e)/2,i=n<e?n+r:n-r,s=Math.abs(o-t)/2,a=o<t?o+s:o-s;return[i,a,r,s]}function ui({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:r,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+r*.375+s*.375+n*.125,u=t*.125+i*.375+a*.375+o*.125,l=Math.abs(c-e),f=Math.abs(u-t);return[c,u,l,f]}var tt;(function(e){e.Strict="strict",e.Loose="loose"})(tt||(tt={}));var je;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(je||(je={}));var zt;(function(e){e.Partial="partial",e.Full="full"})(zt||(zt={}));var Be;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Be||(Be={}));var fn;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(fn||(fn={}));var W;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(W||(W={}));function Jo({pos:e,x1:t,y1:n,x2:o,y2:r}){return e===W.Left||e===W.Right?[.5*(t+o),n]:[t,.5*(n+r)]}function fi({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:r,targetPosition:i=W.Top}){const[s,a]=Jo({pos:n,x1:e,y1:t,x2:o,y2:r}),[c,u]=Jo({pos:i,x1:o,y1:r,x2:e,y2:t}),[l,f,d,g]=ui({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:u});return[`M${e},${t} C${s},${a} ${c},${u} ${o},${r}`,l,f,d,g]}const ho=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:r=W.Bottom,targetPosition:i=W.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:y,interactionWidth:m})=>{const[E,p,_]=fi({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:o,targetPosition:i});return C.createElement(Bt,{path:E,labelX:p,labelY:_,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:y,interactionWidth:m})});ho.displayName="SimpleBezierEdge";const Qo={[W.Left]:{x:-1,y:0},[W.Right]:{x:1,y:0},[W.Top]:{x:0,y:-1},[W.Bottom]:{x:0,y:1}},Ku=({source:e,sourcePosition:t=W.Bottom,target:n})=>t===W.Left||t===W.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},er=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Zu({source:e,sourcePosition:t=W.Bottom,target:n,targetPosition:o=W.Top,center:r,offset:i}){var O,B;const s=Qo[t],a=Qo[o],c={x:e.x+s.x*i,y:e.y+s.y*i},u={x:n.x+a.x*i,y:n.y+a.y*i},l=Ku({source:c,sourcePosition:t,target:u}),f=l.x!==0?"x":"y",d=l[f];let g=[],y,m;const E={x:0,y:0},p={x:0,y:0},[_,N,b,M]=li({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[f]*a[f]===-1){y=(O=r.x)!=null?O:_,m=(B=r.y)!=null?B:N;const R=[{x:y,y:c.y},{x:y,y:u.y}],z=[{x:c.x,y:m},{x:u.x,y:m}];s[f]===d?g=f==="x"?R:z:g=f==="x"?z:R}else{const R=[{x:c.x,y:u.y}],z=[{x:u.x,y:c.y}];if(f==="x"?g=s.x===d?z:R:g=s.y===d?R:z,t===o){const S=Math.abs(e[f]-n[f]);if(S<=i){const x=Math.min(i-1,i-S);s[f]===d?E[f]=(c[f]>e[f]?-1:1)*x:p[f]=(u[f]>n[f]?-1:1)*x}}if(t!==o){const S=f==="x"?"y":"x",x=s[f]===a[S],A=c[S]>u[S],I=c[S]<u[S];(s[f]===1&&(!x&&A||x&&I)||s[f]!==1&&(!x&&I||x&&A))&&(g=f==="x"?R:z)}const L={x:c.x+E.x,y:c.y+E.y},H={x:u.x+p.x,y:u.y+p.y},k=Math.max(Math.abs(L.x-g[0].x),Math.abs(H.x-g[0].x)),h=Math.max(Math.abs(L.y-g[0].y),Math.abs(H.y-g[0].y));k>=h?(y=(L.x+H.x)/2,m=g[0].y):(y=g[0].x,m=(L.y+H.y)/2)}return[[e,{x:c.x+E.x,y:c.y+E.y},...g,{x:u.x+p.x,y:u.y+p.y},n],y,m,b,M]}function qu(e,t,n,o){const r=Math.min(er(e,t)/2,er(t,n)/2,o),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const u=e.x<n.x?-1:1,l=e.y<n.y?1:-1;return`L ${i+r*u},${s}Q ${i},${s} ${i},${s+r*l}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+r*c}Q ${i},${s} ${i+r*a},${s}`}function jn({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:r,targetPosition:i=W.Top,borderRadius:s=5,centerX:a,centerY:c,offset:u=20}){const[l,f,d,g,y]=Zu({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:r},targetPosition:i,center:{x:a,y:c},offset:u});return[l.reduce((E,p,_)=>{let N="";return _>0&&_<l.length-1?N=qu(l[_-1],p,l[_+1],s):N=`${_===0?"M":"L"}${p.x} ${p.y}`,E+=N,E},""),f,d,g,y]}const bn=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,sourcePosition:f=W.Bottom,targetPosition:d=W.Top,markerEnd:g,markerStart:y,pathOptions:m,interactionWidth:E})=>{const[p,_,N]=jn({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:o,targetPosition:d,borderRadius:m==null?void 0:m.borderRadius,offset:m==null?void 0:m.offset});return C.createElement(Bt,{path:p,labelX:_,labelY:N,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:g,markerStart:y,interactionWidth:E})});bn.displayName="SmoothStepEdge";const go=w.memo(e=>{var t;return C.createElement(bn,oe(X({},e),{pathOptions:w.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])}))});go.displayName="StepEdge";function ju({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[r,i,s,a]=li({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,r,i,s,a]}const mo=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:g})=>{const[y,m,E]=ju({sourceX:e,sourceY:t,targetX:n,targetY:o});return C.createElement(Bt,{path:y,labelX:m,labelY:E,label:r,labelStyle:i,labelShowBg:s,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:u,style:l,markerEnd:f,markerStart:d,interactionWidth:g})});mo.displayName="StraightEdge";function Gt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function tr({pos:e,x1:t,y1:n,x2:o,y2:r,c:i}){switch(e){case W.Left:return[t-Gt(t-o,i),n];case W.Right:return[t+Gt(o-t,i),n];case W.Top:return[t,n-Gt(n-r,i)];case W.Bottom:return[t,n+Gt(r-n,i)]}}function di({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:o,targetY:r,targetPosition:i=W.Top,curvature:s=.25}){const[a,c]=tr({pos:n,x1:e,y1:t,x2:o,y2:r,c:s}),[u,l]=tr({pos:i,x1:o,y1:r,x2:e,y2:t,c:s}),[f,d,g,y]=ui({sourceX:e,sourceY:t,targetX:o,targetY:r,sourceControlX:a,sourceControlY:c,targetControlX:u,targetControlY:l});return[`M${e},${t} C${a},${c} ${u},${l} ${o},${r}`,f,d,g,y]}const dn=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:r=W.Bottom,targetPosition:i=W.Top,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:y,pathOptions:m,interactionWidth:E})=>{const[p,_,N]=di({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:o,targetPosition:i,curvature:m==null?void 0:m.curvature});return C.createElement(Bt,{path:p,labelX:_,labelY:N,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:u,labelBgPadding:l,labelBgBorderRadius:f,style:d,markerEnd:g,markerStart:y,interactionWidth:E})});dn.displayName="BezierEdge";const po=w.createContext(null),Ju=po.Provider;po.Consumer;const Qu=()=>w.useContext(po),ef=e=>"id"in e&&"source"in e&&"target"in e,tf=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,Jn=(e,t)=>typeof e=="undefined"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,nf=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),hi=(e,t)=>{if(!e.source||!e.target)return t;let n;return ef(e)?n=X({},e):n=oe(X({},e),{id:tf(e)}),nf(n,t)?t:t.concat(n)},Qn=({x:e,y:t},[n,o,r],i,[s,a])=>{const c={x:(e-n)/r,y:(t-o)/r};return i?{x:s*Math.round(c.x/s),y:a*Math.round(c.y/a)}:c},gi=({x:e,y:t},[n,o,r])=>({x:e*r+n,y:t*r+o}),Qe=(e,t=[0,0])=>{var i,s;if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=((i=e.width)!=null?i:0)*t[0],o=((s=e.height)!=null?s:0)*t[1],r={x:e.position.x-n,y:e.position.y-o};return oe(X({},r),{positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:r})},vn=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,r)=>{const{x:i,y:s}=Qe(r,t).positionAbsolute;return ii(o,Pt({x:i,y:s,width:r.width||0,height:r.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return si(n)},mi=(e,t,[n,o,r]=[0,0,1],i=!1,s=!1,a=[0,0])=>{const c={x:(t.x-n)/r,y:(t.y-o)/r,width:t.width/r,height:t.height/r},u=[];return e.forEach(l=>{const{width:f,height:d,selectable:g=!0,hidden:y=!1}=l;if(s&&!g||y)return!1;const{positionAbsolute:m}=Qe(l,a),E={x:m.x,y:m.y,width:f||0,height:d||0},p=Zn(c,E),_=typeof f=="undefined"||typeof d=="undefined"||f===null||d===null,N=i&&p>0,b=(f||0)*(d||0);(_||N||p>=b||l.dragging)&&u.push(l)}),u},pi=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},yi=(e,t,n,o,r,i=.1)=>{const s=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(s,a),u=xt(c,o,r),l=e.x+e.width/2,f=e.y+e.height/2,d=t/2-l*u,g=n/2-f*u;return{x:d,y:g,zoom:u}},Ze=(e,t=0)=>e.transition().duration(t);function nr(e,t,n,o){return(t[n]||[]).reduce((r,i)=>{var s,a,c,u;return`${e.id}-${i.id}-${n}`!==o&&r.push({id:i.id||null,type:n,nodeId:e.id,x:((a=(s=e.positionAbsolute)==null?void 0:s.x)!=null?a:0)+i.x+i.width/2,y:((u=(c=e.positionAbsolute)==null?void 0:c.y)!=null?u:0)+i.y+i.height/2}),r},[])}function of(e,t,n,o,r,i){const{x:s,y:a}=Ve(e),u=t.elementsFromPoint(s,a).find(y=>y.classList.contains("react-flow__handle"));if(u){const y=u.getAttribute("data-nodeid");if(y){const m=yo(void 0,u),E=u.getAttribute("data-handleid"),p=i({nodeId:y,id:E,type:m});if(p){const _=r.find(N=>N.nodeId===y&&N.type===m&&N.id===E);return{handle:{id:E,type:m,nodeId:y,x:(_==null?void 0:_.x)||n.x,y:(_==null?void 0:_.y)||n.y},validHandleResult:p}}}}let l=[],f=1/0;if(r.forEach(y=>{const m=Math.sqrt(Tn(y.x-n.x,2)+Tn(y.y-n.y,2));if(m<=o){const E=i(y);m<=f&&(m<f?l=[{handle:y,validHandleResult:E}]:m===f&&l.push({handle:y,validHandleResult:E}),f=m)}}),!l.length)return{handle:null,validHandleResult:xi()};if(l.length===1)return l[0];const d=l.some(({validHandleResult:y})=>y.isValid),g=l.some(({handle:y})=>y.type==="target");return l.find(({handle:y,validHandleResult:m})=>g?y.type==="target":d?m.isValid:!0)||l[0]}const rf={source:null,target:null,sourceHandle:null,targetHandle:null},xi=()=>({handleDomNode:null,isValid:!1,connection:rf,endHandle:null});function wi(e,t,n,o,r,i,s){const a=r==="target",c=s.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u=oe(X({},xi()),{handleDomNode:c});if(c){const l=yo(void 0,c),f=c.getAttribute("data-nodeid"),d=c.getAttribute("data-handleid"),g=c.classList.contains("connectable"),y=c.classList.contains("connectableend"),m={source:a?f:n,sourceHandle:a?d:o,target:a?n:f,targetHandle:a?o:d};u.connection=m,g&&y&&(t===tt.Strict?a&&l==="source"||!a&&l==="target":f!==n||d!==o)&&(u.endHandle={nodeId:f,handleId:d,type:l},u.isValid=i(m))}return u}function sf({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((r,i)=>{if(i[ie]){const{handleBounds:s}=i[ie];let a=[],c=[];s&&(a=nr(i,s,"source",`${t}-${n}-${o}`),c=nr(i,s,"target",`${t}-${n}-${o}`)),r.push(...a,...c)}return r},[])}function yo(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Pn(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function af(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function bi({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:r,getState:i,setState:s,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:u}){const l=ri(e.target),{connectionMode:f,domNode:d,autoPanOnConnect:g,connectionRadius:y,onConnectStart:m,panBy:E,getNodes:p,cancelConnection:_}=i();let N=0,b;const{x:M,y:$}=Ve(e),O=l==null?void 0:l.elementFromPoint(M,$),B=yo(c,O),R=d==null?void 0:d.getBoundingClientRect();if(!R||!B)return;let z,L=Ve(e,R),H=!1,k=null,h=!1,S=null;const x=sf({nodes:p(),nodeId:n,handleId:t,handleType:B}),A=()=>{if(!g)return;const[T,P]=oi(L,R);E({x:T,y:P}),N=requestAnimationFrame(A)};s({connectionPosition:L,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:B,connectionStartHandle:{nodeId:n,handleId:t,type:B},connectionEndHandle:null}),m==null||m(e,{nodeId:n,handleId:t,handleType:B});function I(T){const{transform:P}=i();L=Ve(T,R);const{handle:D,validHandleResult:V}=of(T,l,Qn(L,P,!1,[1,1]),y,x,F=>wi(F,f,n,t,r?"target":"source",a,l));if(b=D,H||(A(),H=!0),S=V.handleDomNode,k=V.connection,h=V.isValid,s({connectionPosition:b&&h?gi({x:b.x,y:b.y},P):L,connectionStatus:af(!!b,h),connectionEndHandle:V.endHandle}),!b&&!h&&!S)return Pn(z);k.source!==k.target&&S&&(Pn(z),z=S,S.classList.add("connecting","react-flow__handle-connecting"),S.classList.toggle("valid",h),S.classList.toggle("react-flow__handle-valid",h))}function v(T){var P,D;(b||S)&&k&&h&&(o==null||o(k)),(D=(P=i()).onConnectEnd)==null||D.call(P,T),c&&(u==null||u(T)),Pn(z),_(),cancelAnimationFrame(N),H=!1,h=!1,k=null,S=null,l.removeEventListener("mousemove",I),l.removeEventListener("mouseup",v),l.removeEventListener("touchmove",I),l.removeEventListener("touchend",v)}l.addEventListener("mousemove",I),l.addEventListener("mouseup",v),l.addEventListener("touchmove",I),l.addEventListener("touchend",v)}const or=()=>!0,cf=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),lf=(e,t,n)=>o=>{const{connectionStartHandle:r,connectionEndHandle:i,connectionClickStartHandle:s}=o;return{connecting:(r==null?void 0:r.nodeId)===e&&(r==null?void 0:r.handleId)===t&&(r==null?void 0:r.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n}},vi=w.forwardRef((y,g)=>{var m=y,{type:e="source",position:t=W.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:r=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:u,onMouseDown:l,onTouchStart:f}=m,d=st(m,["type","position","isValidConnection","isConnectable","isConnectableStart","isConnectableEnd","id","onConnect","children","className","onMouseDown","onTouchStart"]);var L,H;const E=s||null,p=e==="target",_=ce(),N=Qu(),{connectOnClick:b,noPanClassName:M}=ne(cf,le),{connecting:$,clickConnecting:O}=ne(lf(N,E,e),le);N||(H=(L=_.getState()).onError)==null||H.call(L,"010",Pe.error010());const B=k=>{const{defaultEdgeOptions:h,onConnect:S,hasDefaultEdges:x}=_.getState(),A=X(X({},h),k);if(x){const{edges:I,setEdges:v}=_.getState();v(hi(A,I))}S==null||S(A),a==null||a(A)},R=k=>{if(!N)return;const h=ci(k);r&&(h&&k.button===0||!h)&&bi({event:k,handleId:E,nodeId:N,onConnect:B,isTarget:p,getState:_.getState,setState:_.setState,isValidConnection:n||_.getState().isValidConnection||or}),h?l==null||l(k):f==null||f(k)},z=k=>{const{onClickConnectStart:h,onClickConnectEnd:S,connectionClickStartHandle:x,connectionMode:A,isValidConnection:I}=_.getState();if(!N||!x&&!r)return;if(!x){h==null||h(k,{nodeId:N,handleId:E,handleType:e}),_.setState({connectionClickStartHandle:{nodeId:N,type:e,handleId:E}});return}const v=ri(k.target),T=n||I||or,{connection:P,isValid:D}=wi({nodeId:N,id:E,type:e},A,x.nodeId,x.handleId||null,x.type,T,v);D&&B(P),S==null||S(k),_.setState({connectionClickStartHandle:null})};return C.createElement("div",X({"data-handleid":E,"data-nodeid":N,"data-handlepos":t,"data-id":`${N}-${E}-${e}`,className:de(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",M,u,{source:!p,target:p,connectable:o,connectablestart:r,connectableend:i,connecting:O,connectionindicator:o&&(r&&!$||i&&$)}]),onMouseDown:R,onTouchStart:R,onClick:b?z:void 0,ref:g},d),c)});vi.displayName="Handle";var hn=w.memo(vi);const _i=({data:e,isConnectable:t,targetPosition:n=W.Top,sourcePosition:o=W.Bottom})=>C.createElement(C.Fragment,null,C.createElement(hn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,C.createElement(hn,{type:"source",position:o,isConnectable:t}));_i.displayName="DefaultNode";var eo=w.memo(_i);const Si=({data:e,isConnectable:t,sourcePosition:n=W.Bottom})=>C.createElement(C.Fragment,null,e==null?void 0:e.label,C.createElement(hn,{type:"source",position:n,isConnectable:t}));Si.displayName="InputNode";var Ei=w.memo(Si);const Ni=({data:e,isConnectable:t,targetPosition:n=W.Top})=>C.createElement(C.Fragment,null,C.createElement(hn,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);Ni.displayName="OutputNode";var Ci=w.memo(Ni);const xo=()=>null;xo.displayName="GroupNode";const uf=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>X({},t))}),Kt=e=>e.id;function ff(e,t){return le(e.selectedNodes.map(Kt),t.selectedNodes.map(Kt))&&le(e.selectedEdges.map(Kt),t.selectedEdges.map(Kt))}const Mi=w.memo(({onSelectionChange:e})=>{const t=ce(),{selectedNodes:n,selectedEdges:o}=ne(uf,ff);return w.useEffect(()=>{const r={nodes:n,edges:o};e==null||e(r),t.getState().onSelectionChange.forEach(i=>i(r))},[n,o,e]),null});Mi.displayName="SelectionListener";const df=e=>!!e.onSelectionChange;function hf({onSelectionChange:e}){const t=ne(df);return e||t?C.createElement(Mi,{onSelectionChange:e}):null}const gf=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function at(e,t){w.useEffect(()=>{typeof e!="undefined"&&t(e)},[e])}function Z(e,t,n){w.useEffect(()=>{typeof t!="undefined"&&n({[e]:t})},[t])}const mf=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:r,onConnectStart:i,onConnectEnd:s,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:l,nodesFocusable:f,edgesFocusable:d,edgesUpdatable:g,elevateNodesOnSelect:y,minZoom:m,maxZoom:E,nodeExtent:p,onNodesChange:_,onEdgesChange:N,elementsSelectable:b,connectionMode:M,snapGrid:$,snapToGrid:O,translateExtent:B,connectOnClick:R,defaultEdgeOptions:z,fitView:L,fitViewOptions:H,onNodesDelete:k,onEdgesDelete:h,onNodeDrag:S,onNodeDragStart:x,onNodeDragStop:A,onSelectionDrag:I,onSelectionDragStart:v,onSelectionDragStop:T,noPanClassName:P,nodeOrigin:D,rfId:V,autoPanOnConnect:F,autoPanOnNodeDrag:U,onError:K,connectionRadius:G,isValidConnection:j,nodeDragThreshold:ee})=>{const{setNodes:se,setEdges:re,setDefaultNodesAndEdges:J,setMinZoom:ue,setMaxZoom:ae,setTranslateExtent:te,setNodeExtent:fe,reset:Q}=ne(gf,le),Y=ce();return w.useEffect(()=>{const he=o==null?void 0:o.map(Ae=>X(X({},Ae),z));return J(n,he),()=>{Q()}},[]),Z("defaultEdgeOptions",z,Y.setState),Z("connectionMode",M,Y.setState),Z("onConnect",r,Y.setState),Z("onConnectStart",i,Y.setState),Z("onConnectEnd",s,Y.setState),Z("onClickConnectStart",a,Y.setState),Z("onClickConnectEnd",c,Y.setState),Z("nodesDraggable",u,Y.setState),Z("nodesConnectable",l,Y.setState),Z("nodesFocusable",f,Y.setState),Z("edgesFocusable",d,Y.setState),Z("edgesUpdatable",g,Y.setState),Z("elementsSelectable",b,Y.setState),Z("elevateNodesOnSelect",y,Y.setState),Z("snapToGrid",O,Y.setState),Z("snapGrid",$,Y.setState),Z("onNodesChange",_,Y.setState),Z("onEdgesChange",N,Y.setState),Z("connectOnClick",R,Y.setState),Z("fitViewOnInit",L,Y.setState),Z("fitViewOnInitOptions",H,Y.setState),Z("onNodesDelete",k,Y.setState),Z("onEdgesDelete",h,Y.setState),Z("onNodeDrag",S,Y.setState),Z("onNodeDragStart",x,Y.setState),Z("onNodeDragStop",A,Y.setState),Z("onSelectionDrag",I,Y.setState),Z("onSelectionDragStart",v,Y.setState),Z("onSelectionDragStop",T,Y.setState),Z("noPanClassName",P,Y.setState),Z("nodeOrigin",D,Y.setState),Z("rfId",V,Y.setState),Z("autoPanOnConnect",F,Y.setState),Z("autoPanOnNodeDrag",U,Y.setState),Z("onError",K,Y.setState),Z("connectionRadius",G,Y.setState),Z("isValidConnection",j,Y.setState),Z("nodeDragThreshold",ee,Y.setState),at(e,se),at(t,re),at(m,ue),at(E,ae),at(B,te),at(p,fe),null},rr={display:"none"},pf={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Ai="react-flow__node-desc",Ti="react-flow__edge-desc",yf="react-flow__aria-live",xf=e=>e.ariaLiveMessage;function wf({rfId:e}){const t=ne(xf);return C.createElement("div",{id:`${yf}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:pf},t)}function bf({rfId:e,disableKeyboardA11y:t}){return C.createElement(C.Fragment,null,C.createElement("div",{id:`${Ai}-${e}`,style:rr},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),C.createElement("div",{id:`${Ti}-${e}`,style:rr},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&C.createElement(wf,{rfId:e}))}var Ot=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=w.useState(!1),r=w.useRef(!1),i=w.useRef(new Set([])),[s,a]=w.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),l=u.reduce((f,d)=>f.concat(...d),[]);return[u,l]}return[[],[]]},[e]);return w.useEffect(()=>{const c=typeof document!="undefined"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const l=g=>{if(r.current=g.ctrlKey||g.metaKey||g.shiftKey,(!r.current||r.current&&!t.actInsideInputWithModifier)&&qn(g))return!1;const m=sr(g.code,a);i.current.add(g[m]),ir(s,i.current,!1)&&(g.preventDefault(),o(!0))},f=g=>{if((!r.current||r.current&&!t.actInsideInputWithModifier)&&qn(g))return!1;const m=sr(g.code,a);ir(s,i.current,!0)?(o(!1),i.current.clear()):i.current.delete(g[m]),g.key==="Meta"&&i.current.clear(),r.current=!1},d=()=>{i.current.clear(),o(!1)};return u==null||u.addEventListener("keydown",l),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",d),()=>{u==null||u.removeEventListener("keydown",l),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",d)}}},[e,o]),n};function ir(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(r=>t.has(r)))}function sr(e,t){return t.includes(e)?"code":"key"}function ki(e,t,n,o){var a,c,u,l,f,d,g,y;const r=e.parentNode||e.parentId;if(!r)return n;const i=t.get(r),s=Qe(i,o);return ki(i,t,{x:((a=n.x)!=null?a:0)+s.x,y:((c=n.y)!=null?c:0)+s.y,z:((l=(u=i[ie])==null?void 0:u.z)!=null?l:0)>((f=n.z)!=null?f:0)?(g=(d=i[ie])==null?void 0:d.z)!=null?g:0:(y=n.z)!=null?y:0},o)}function $i(e,t,n){e.forEach(o=>{var i,s;const r=o.parentNode||o.parentId;if(r&&!e.has(r))throw new Error(`Parent node ${r} not found`);if(r||n!=null&&n[o.id]){const{x:a,y:c,z:u}=ki(o,e,oe(X({},o.position),{z:(s=(i=o[ie])==null?void 0:i.z)!=null?s:0}),t);o.positionAbsolute={x:a,y:c},o[ie].z=u,n!=null&&n[o.id]&&(o[ie].isParent=!0)}})}function zn(e,t,n,o){const r=new Map,i={},s=o?1e3:0;return e.forEach(a=>{var g;const c=(we(a.zIndex)?a.zIndex:0)+(a.selected?s:0),u=t.get(a.id),l=oe(X({},a),{positionAbsolute:{x:a.position.x,y:a.position.y}}),f=a.parentNode||a.parentId;f&&(i[f]=!0);const d=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==a.type;Object.defineProperty(l,ie,{enumerable:!1,value:{handleBounds:d||(g=u==null?void 0:u[ie])==null?void 0:g.handleBounds,z:c}}),r.set(a.id,l)}),$i(r,n,i),r}function Ri(e,t={}){var y,m,E;const{getNodes:n,width:o,height:r,minZoom:i,maxZoom:s,d3Zoom:a,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:l,nodeOrigin:f}=e(),d=t.initial&&!u&&l;if(a&&c&&(d||!t.initial)){const p=n().filter(N=>{var M;const b=t.includeHiddenNodes?N.width&&N.height:!N.hidden;return(M=t.nodes)!=null&&M.length?b&&t.nodes.some($=>$.id===N.id):b}),_=p.every(N=>N.width&&N.height);if(p.length>0&&_){const N=vn(p,f),{x:b,y:M,zoom:$}=yi(N,o,r,(y=t.minZoom)!=null?y:i,(m=t.maxZoom)!=null?m:s,(E=t.padding)!=null?E:.1),O=Ie.translate(b,M).scale($);return typeof t.duration=="number"&&t.duration>0?a.transform(Ze(c,t.duration),O):a.transform(c,O),!0}}return!1}function vf(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,oe(X({},o),{[ie]:o[ie],selected:n.selected}))}),new Map(t)}function _f(e,t){return t.map(n=>{const o=e.find(r=>r.id===n.id);return o&&(n.selected=o.selected),n})}function Zt({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:r,edges:i,onNodesChange:s,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:u}=n();e!=null&&e.length&&(c&&o({nodeInternals:vf(e,r)}),s==null||s(e)),t!=null&&t.length&&(u&&o({edges:_f(t,i)}),a==null||a(t))}const ct=()=>{},Sf={zoomIn:ct,zoomOut:ct,zoomTo:ct,getZoom:()=>1,setViewport:ct,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:ct,fitBounds:ct,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},Ef=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),Nf=()=>{const e=ce(),{d3Zoom:t,d3Selection:n}=ne(Ef,le);return w.useMemo(()=>n&&t?{zoomIn:r=>t.scaleBy(Ze(n,r==null?void 0:r.duration),1.2),zoomOut:r=>t.scaleBy(Ze(n,r==null?void 0:r.duration),1/1.2),zoomTo:(r,i)=>t.scaleTo(Ze(n,i==null?void 0:i.duration),r),getZoom:()=>e.getState().transform[2],setViewport:(r,i)=>{var l,f,d;const[s,a,c]=e.getState().transform,u=Ie.translate((l=r.x)!=null?l:s,(f=r.y)!=null?f:a).scale((d=r.zoom)!=null?d:c);t.transform(Ze(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[r,i,s]=e.getState().transform;return{x:r,y:i,zoom:s}},fitView:r=>Ri(e.getState,r),setCenter:(r,i,s)=>{const{width:a,height:c,maxZoom:u}=e.getState(),l=typeof(s==null?void 0:s.zoom)!="undefined"?s.zoom:u,f=a/2-r*l,d=c/2-i*l,g=Ie.translate(f,d).scale(l);t.transform(Ze(n,s==null?void 0:s.duration),g)},fitBounds:(r,i)=>{var y;const{width:s,height:a,minZoom:c,maxZoom:u}=e.getState(),{x:l,y:f,zoom:d}=yi(r,s,a,c,u,(y=i==null?void 0:i.padding)!=null?y:.1),g=Ie.translate(l,f).scale(d);t.transform(Ze(n,i==null?void 0:i.duration),g)},project:r=>{const{transform:i,snapToGrid:s,snapGrid:a}=e.getState();return Qn(r,i,s,a)},screenToFlowPosition:r=>{const{transform:i,snapToGrid:s,snapGrid:a,domNode:c}=e.getState();if(!c)return r;const{x:u,y:l}=c.getBoundingClientRect(),f={x:r.x-u,y:r.y-l};return Qn(f,i,s,a)},flowToScreenPosition:r=>{const{transform:i,domNode:s}=e.getState();if(!s)return r;const{x:a,y:c}=s.getBoundingClientRect(),u=gi(r,i);return{x:u.x+a,y:u.y+c}},viewportInitialized:!0}:Sf,[t,n])};function wo(){const e=Nf(),t=ce(),n=w.useCallback(()=>t.getState().getNodes().map(m=>X({},m)),[]),o=w.useCallback(m=>t.getState().nodeInternals.get(m),[]),r=w.useCallback(()=>{const{edges:m=[]}=t.getState();return m.map(E=>X({},E))},[]),i=w.useCallback(m=>{const{edges:E=[]}=t.getState();return E.find(p=>p.id===m)},[]),s=w.useCallback(m=>{const{getNodes:E,setNodes:p,hasDefaultNodes:_,onNodesChange:N}=t.getState(),b=E(),M=typeof m=="function"?m(b):m;if(_)p(M);else if(N){const $=M.length===0?b.map(O=>({type:"remove",id:O.id})):M.map(O=>({item:O,type:"reset"}));N($)}},[]),a=w.useCallback(m=>{const{edges:E=[],setEdges:p,hasDefaultEdges:_,onEdgesChange:N}=t.getState(),b=typeof m=="function"?m(E):m;if(_)p(b);else if(N){const M=b.length===0?E.map($=>({type:"remove",id:$.id})):b.map($=>({item:$,type:"reset"}));N(M)}},[]),c=w.useCallback(m=>{const E=Array.isArray(m)?m:[m],{getNodes:p,setNodes:_,hasDefaultNodes:N,onNodesChange:b}=t.getState();if(N){const $=[...p(),...E];_($)}else if(b){const M=E.map($=>({item:$,type:"add"}));b(M)}},[]),u=w.useCallback(m=>{const E=Array.isArray(m)?m:[m],{edges:p=[],setEdges:_,hasDefaultEdges:N,onEdgesChange:b}=t.getState();if(N)_([...p,...E]);else if(b){const M=E.map($=>({item:$,type:"add"}));b(M)}},[]),l=w.useCallback(()=>{const{getNodes:m,edges:E=[],transform:p}=t.getState(),[_,N,b]=p;return{nodes:m().map(M=>X({},M)),edges:E.map(M=>X({},M)),viewport:{x:_,y:N,zoom:b}}},[]),f=w.useCallback(({nodes:m,edges:E})=>{const{nodeInternals:p,getNodes:_,edges:N,hasDefaultNodes:b,hasDefaultEdges:M,onNodesDelete:$,onEdgesDelete:O,onNodesChange:B,onEdgesChange:R}=t.getState(),z=(m||[]).map(S=>S.id),L=(E||[]).map(S=>S.id),H=_().reduce((S,x)=>{const A=x.parentNode||x.parentId,I=!z.includes(x.id)&&A&&S.find(T=>T.id===A);return(typeof x.deletable=="boolean"?x.deletable:!0)&&(z.includes(x.id)||I)&&S.push(x),S},[]),k=N.filter(S=>typeof S.deletable=="boolean"?S.deletable:!0),h=k.filter(S=>L.includes(S.id));if(H||h){const S=pi(H,k),x=[...h,...S],A=x.reduce((I,v)=>(I.includes(v.id)||I.push(v.id),I),[]);if((M||b)&&(M&&t.setState({edges:N.filter(I=>!A.includes(I.id))}),b&&(H.forEach(I=>{p.delete(I.id)}),t.setState({nodeInternals:new Map(p)}))),A.length>0&&(O==null||O(x),R&&R(A.map(I=>({id:I,type:"remove"})))),H.length>0&&($==null||$(H),B)){const I=H.map(v=>({id:v.id,type:"remove"}));B(I)}}},[]),d=w.useCallback(m=>{const E=Wu(m),p=E?null:t.getState().nodeInternals.get(m.id);return!E&&!p?[null,null,E]:[E?m:jo(p),p,E]},[]),g=w.useCallback((m,E=!0,p)=>{const[_,N,b]=d(m);return _?(p||t.getState().getNodes()).filter(M=>{if(!b&&(M.id===N.id||!M.positionAbsolute))return!1;const $=jo(M),O=Zn($,_);return E&&O>0||O>=_.width*_.height}):[]},[]),y=w.useCallback((m,E,p=!0)=>{const[_]=d(m);if(!_)return!1;const N=Zn(_,E);return p&&N>0||N>=_.width*_.height},[]);return w.useMemo(()=>oe(X({},e),{getNodes:n,getNode:o,getEdges:r,getEdge:i,setNodes:s,setEdges:a,addNodes:c,addEdges:u,toObject:l,deleteElements:f,getIntersectingNodes:g,isNodeIntersecting:y}),[e,n,o,r,i,s,a,c,u,l,f,g,y])}const Cf={actInsideInputWithModifier:!1};var Mf=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ce(),{deleteElements:o}=wo(),r=Ot(e,Cf),i=Ot(t);w.useEffect(()=>{if(r){const{edges:s,getNodes:a}=n.getState(),c=a().filter(l=>l.selected),u=s.filter(l=>l.selected);o({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[r]),w.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function Af(e){const t=ce();w.useEffect(()=>{let n;const o=()=>{var i,s;if(!e.current)return;const r=uo(e.current);(r.height===0||r.width===0)&&((s=(i=t.getState()).onError)==null||s.call(i,"004",Pe.error004())),t.setState({width:r.width||500,height:r.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const bo={position:"absolute",width:"100%",height:"100%",top:0,left:0},Tf=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,qt=e=>({x:e.x,y:e.y,zoom:e.k}),lt=(e,t)=>e.target.closest(`.${t}`),ar=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),cr=e=>{const t=e.ctrlKey&&un()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},kf=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),$f=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:r=!0,zoomOnPinch:i=!0,panOnScroll:s=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=je.Free,zoomOnDoubleClick:u=!0,elementsSelectable:l,panOnDrag:f=!0,defaultViewport:d,translateExtent:g,minZoom:y,maxZoom:m,zoomActivationKeyCode:E,preventScrolling:p=!0,children:_,noWheelClassName:N,noPanClassName:b})=>{const M=w.useRef(),$=ce(),O=w.useRef(!1),B=w.useRef(!1),R=w.useRef(null),z=w.useRef({x:0,y:0,zoom:0}),{d3Zoom:L,d3Selection:H,d3ZoomHandler:k,userSelectionActive:h}=ne(kf,le),S=Ot(E),x=w.useRef(0),A=w.useRef(!1),I=w.useRef();return Af(R),w.useEffect(()=>{if(R.current){const v=R.current.getBoundingClientRect(),T=ti().scaleExtent([y,m]).translateExtent(g),P=xe(R.current).call(T),D=Ie.translate(d.x,d.y).scale(xt(d.zoom,y,m)),V=[[0,0],[v.width,v.height]],F=T.constrain()(D,V,g);T.transform(P,F),T.wheelDelta(cr),$.setState({d3Zoom:T,d3Selection:P,d3ZoomHandler:P.on("wheel.zoom"),transform:[F.x,F.y,F.k],domNode:R.current.closest(".react-flow")})}},[]),w.useEffect(()=>{H&&L&&(s&&!S&&!h?H.on("wheel.zoom",v=>{if(lt(v,N))return!1;v.preventDefault(),v.stopImmediatePropagation();const T=H.property("__zoom").k||1;if(v.ctrlKey&&i){const j=ve(v),ee=cr(v),se=T*Math.pow(2,ee);L.scaleTo(H,se,j,v);return}const P=v.deltaMode===1?20:1;let D=c===je.Vertical?0:v.deltaX*P,V=c===je.Horizontal?0:v.deltaY*P;!un()&&v.shiftKey&&c!==je.Vertical&&(D=v.deltaY*P,V=0),L.translateBy(H,-(D/T)*a,-(V/T)*a,{internal:!0});const F=qt(H.property("__zoom")),{onViewportChangeStart:U,onViewportChange:K,onViewportChangeEnd:G}=$.getState();clearTimeout(I.current),A.current||(A.current=!0,t==null||t(v,F),U==null||U(F)),A.current&&(e==null||e(v,F),K==null||K(F),I.current=setTimeout(()=>{n==null||n(v,F),G==null||G(F),A.current=!1},150))},{passive:!1}):typeof k!="undefined"&&H.on("wheel.zoom",function(v,T){if(!p&&v.type==="wheel"&&!v.ctrlKey||lt(v,N))return null;v.preventDefault(),k.call(this,v,T)},{passive:!1}))},[h,s,c,H,L,k,S,i,p,N,t,e,n]),w.useEffect(()=>{L&&L.on("start",v=>{var D,V;if(!v.sourceEvent||v.sourceEvent.internal)return null;x.current=(D=v.sourceEvent)==null?void 0:D.button;const{onViewportChangeStart:T}=$.getState(),P=qt(v.transform);O.current=!0,z.current=P,((V=v.sourceEvent)==null?void 0:V.type)==="mousedown"&&$.setState({paneDragging:!0}),T==null||T(P),t==null||t(v.sourceEvent,P)})},[L,t]),w.useEffect(()=>{L&&(h&&!O.current?L.on("zoom",null):h||L.on("zoom",v=>{var P,D;const{onViewportChange:T}=$.getState();if($.setState({transform:[v.transform.x,v.transform.y,v.transform.k]}),B.current=!!(o&&ar(f,(P=x.current)!=null?P:0)),(e||T)&&!((D=v.sourceEvent)!=null&&D.internal)){const V=qt(v.transform);T==null||T(V),e==null||e(v.sourceEvent,V)}}))},[h,L,e,f,o]),w.useEffect(()=>{L&&L.on("end",v=>{var P;if(!v.sourceEvent||v.sourceEvent.internal)return null;const{onViewportChangeEnd:T}=$.getState();if(O.current=!1,$.setState({paneDragging:!1}),o&&ar(f,(P=x.current)!=null?P:0)&&!B.current&&o(v.sourceEvent),B.current=!1,(n||T)&&Tf(z.current,v.transform)){const D=qt(v.transform);z.current=D,clearTimeout(M.current),M.current=setTimeout(()=>{T==null||T(D),n==null||n(v.sourceEvent,D)},s?150:0)}})},[L,s,f,n,o]),w.useEffect(()=>{L&&L.filter(v=>{const T=S||r,P=i&&v.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&v.button===1&&v.type==="mousedown"&&(lt(v,"react-flow__node")||lt(v,"react-flow__edge")))return!0;if(!f&&!T&&!s&&!u&&!i||h||!u&&v.type==="dblclick"||lt(v,N)&&v.type==="wheel"||lt(v,b)&&(v.type!=="wheel"||s&&v.type==="wheel"&&!S)||!i&&v.ctrlKey&&v.type==="wheel"||!T&&!s&&!P&&v.type==="wheel"||!f&&(v.type==="mousedown"||v.type==="touchstart")||Array.isArray(f)&&!f.includes(v.button)&&v.type==="mousedown")return!1;const D=Array.isArray(f)&&f.includes(v.button)||!v.button||v.button<=1;return(!v.ctrlKey||v.type==="wheel")&&D})},[h,L,r,i,s,u,f,l,S]),C.createElement("div",{className:"react-flow__renderer",ref:R,style:bo},_)},Rf=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function If(){const{userSelectionActive:e,userSelectionRect:t}=ne(Rf,le);return e&&t?C.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function lr(e,t){var r,i;const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,a=t.position.y+t.height-o.height;if(s>0||a>0||t.position.x<0||t.position.y<0){if(o.style=X({},o.style)||{},o.style.width=(r=o.style.width)!=null?r:o.width,o.style.height=(i=o.style.height)!=null?i:o.height,s>0&&(o.style.width+=s),a>0&&(o.style.height+=a),t.position.x<0){const c=Math.abs(t.position.x);o.position.x=o.position.x-c,o.style.width+=c,t.position.x=0}if(t.position.y<0){const c=Math.abs(t.position.y);o.position.y=o.position.y-c,o.style.height+=c,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Ii(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,r)=>{const i=e.filter(a=>a.id===r.id);if(i.length===0)return o.push(r),o;const s=X({},r);for(const a of i)if(a)switch(a.type){case"select":{s.selected=a.selected;break}case"position":{typeof a.position!="undefined"&&(s.position=a.position),typeof a.positionAbsolute!="undefined"&&(s.positionAbsolute=a.positionAbsolute),typeof a.dragging!="undefined"&&(s.dragging=a.dragging),s.expandParent&&lr(o,s);break}case"dimensions":{typeof a.dimensions!="undefined"&&(s.width=a.dimensions.width,s.height=a.dimensions.height),typeof a.updateStyle!="undefined"&&(s.style=X(X({},s.style||{}),a.dimensions)),typeof a.resizing=="boolean"&&(s.resizing=a.resizing),s.expandParent&&lr(o,s);break}case"remove":return o}return o.push(s),o},n)}function Di(e,t){return Ii(e,t)}function Df(e,t){return Ii(e,t)}const Le=(e,t)=>({id:e,type:"select",selected:t});function ft(e,t){return e.reduce((n,o)=>{const r=t.includes(o.id);return!o.selected&&r?(o.selected=!0,n.push(Le(o.id,!0))):o.selected&&!r&&(o.selected=!1,n.push(Le(o.id,!1))),n},[])}const On=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Pf=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Pi=w.memo(({isSelecting:e,selectionMode:t=zt.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:r,onPaneClick:i,onPaneContextMenu:s,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:l,children:f})=>{const d=w.useRef(null),g=ce(),y=w.useRef(0),m=w.useRef(0),E=w.useRef(),{userSelectionActive:p,elementsSelectable:_,dragging:N}=ne(Pf,le),b=()=>{g.setState({userSelectionActive:!1,userSelectionRect:null}),y.current=0,m.current=0},M=k=>{i==null||i(k),g.getState().resetSelectedElements(),g.setState({nodesSelectionActive:!1})},$=k=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){k.preventDefault();return}s==null||s(k)},O=a?k=>a(k):void 0,B=k=>{const{resetSelectedElements:h,domNode:S}=g.getState();if(E.current=S==null?void 0:S.getBoundingClientRect(),!_||!e||k.button!==0||k.target!==d.current||!E.current)return;const{x,y:A}=Ve(k,E.current);h(),g.setState({userSelectionRect:{width:0,height:0,startX:x,startY:A,x,y:A}}),o==null||o(k)},R=k=>{var se,re;const{userSelectionRect:h,nodeInternals:S,edges:x,transform:A,onNodesChange:I,onEdgesChange:v,nodeOrigin:T,getNodes:P}=g.getState();if(!e||!E.current||!h)return;g.setState({userSelectionActive:!0,nodesSelectionActive:!1});const D=Ve(k,E.current),V=(se=h.startX)!=null?se:0,F=(re=h.startY)!=null?re:0,U=oe(X({},h),{x:D.x<V?D.x:V,y:D.y<F?D.y:F,width:Math.abs(D.x-V),height:Math.abs(D.y-F)}),K=P(),G=mi(S,U,A,t===zt.Partial,!0,T),j=pi(G,x).map(J=>J.id),ee=G.map(J=>J.id);if(y.current!==ee.length){y.current=ee.length;const J=ft(K,ee);J.length&&(I==null||I(J))}if(m.current!==j.length){m.current=j.length;const J=ft(x,j);J.length&&(v==null||v(J))}g.setState({userSelectionRect:U})},z=k=>{if(k.button!==0)return;const{userSelectionRect:h}=g.getState();!p&&h&&k.target===d.current&&(M==null||M(k)),g.setState({nodesSelectionActive:y.current>0}),b(),r==null||r(k)},L=k=>{p&&(g.setState({nodesSelectionActive:y.current>0}),r==null||r(k)),b()},H=_&&(e||p);return C.createElement("div",{className:de(["react-flow__pane",{dragging:N,selection:e}]),onClick:H?void 0:On(M,d),onContextMenu:On($,d),onWheel:On(O,d),onMouseEnter:H?void 0:c,onMouseDown:H?B:void 0,onMouseMove:H?R:u,onMouseUp:H?z:void 0,onMouseLeave:H?L:l,ref:d,style:bo},f,C.createElement(If,null))});Pi.displayName="Pane";function zi(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:zi(o,t):!1}function ur(e,t,n){let o=e;do{if(o!=null&&o.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function zf(e,t,n,o){return Array.from(e.values()).filter(r=>(r.selected||r.id===o)&&(!r.parentNode||r.parentId||!zi(r,e))&&(r.draggable||t&&typeof r.draggable=="undefined")).map(r=>{var i,s,a,c;return{id:r.id,position:r.position||{x:0,y:0},positionAbsolute:r.positionAbsolute||{x:0,y:0},distance:{x:n.x-((s=(i=r.positionAbsolute)==null?void 0:i.x)!=null?s:0),y:n.y-((c=(a=r.positionAbsolute)==null?void 0:a.y)!=null?c:0)},delta:{x:0,y:0},extent:r.extent,parentNode:r.parentNode||r.parentId,parentId:r.parentNode||r.parentId,width:r.width,height:r.height,expandParent:r.expandParent}})}function Of(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Oi(e,t,n,o,r=[0,0],i){const s=Of(e,e.extent||o);let a=s;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:d,y:g}=Qe(f,r).positionAbsolute;a=f&&we(d)&&we(g)&&we(f.width)&&we(f.height)?[[d+e.width*r[0],g+e.height*r[1]],[d+f.width-e.width+e.width*r[0],g+f.height-e.height+e.height*r[1]]]:a}else i==null||i("005",Pe.error005()),a=s;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:d,y:g}=Qe(f,r).positionAbsolute;a=[[e.extent[0][0]+d,e.extent[0][1]+g],[e.extent[1][0]+d,e.extent[1][1]+g]]}let u={x:0,y:0};if(c){const f=n.get(c);u=Qe(f,r).positionAbsolute}const l=a&&a!=="parent"?fo(t,a):t;return{position:{x:l.x-u.x,y:l.y-u.y},positionAbsolute:l}}function Hn({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(r=>{const i=n.get(r.id);return oe(X({},i),{position:r.position,positionAbsolute:r.positionAbsolute})});return[e?o.find(r=>r.id===e):o[0],o]}const fr=(e,t,n,o)=>{const r=t.querySelectorAll(e);if(!r||!r.length)return null;const i=Array.from(r),s=t.getBoundingClientRect(),a={x:s.width*o[0],y:s.height*o[1]};return i.map(c=>{const u=c.getBoundingClientRect();return X({id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-s.left-a.x)/n,y:(u.top-s.top-a.y)/n},uo(c))})};function Nt(e,t,n){return n===void 0?n:o=>{const r=t().nodeInternals.get(e);r&&n(o,X({},r))}}function to({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:r,unselectNodesAndEdges:i,multiSelectionActive:s,nodeInternals:a,onError:c}=t.getState(),u=a.get(e);if(!u){c==null||c("012",Pe.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&s)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var l;return(l=o==null?void 0:o.current)==null?void 0:l.blur()})):r([e])}function Hf(){const e=ce();return w.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:r,snapToGrid:i}=e.getState(),s=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(s-o[0])/o[2],y:(a-o[1])/o[2]};return X({xSnapped:i?r[0]*Math.round(c.x/r[0]):c.x,ySnapped:i?r[1]*Math.round(c.y/r[1]):c.y},c)},[])}function Ln(e){return(t,n,o)=>e==null?void 0:e(t,o)}function Hi({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:r,isSelectable:i,selectNodesOnDrag:s}){const a=ce(),[c,u]=w.useState(!1),l=w.useRef([]),f=w.useRef({x:null,y:null}),d=w.useRef(0),g=w.useRef(null),y=w.useRef({x:0,y:0}),m=w.useRef(null),E=w.useRef(!1),p=w.useRef(!1),_=w.useRef(!1),N=Hf();return w.useEffect(()=>{if(e!=null&&e.current){const b=xe(e.current),M=({x:B,y:R})=>{const{nodeInternals:z,onNodeDrag:L,onSelectionDrag:H,updateNodePositions:k,nodeExtent:h,snapGrid:S,snapToGrid:x,nodeOrigin:A,onError:I}=a.getState();f.current={x:B,y:R};let v=!1,T={x:0,y:0,x2:0,y2:0};if(l.current.length>1&&h){const D=vn(l.current,A);T=Pt(D)}if(l.current=l.current.map(D=>{var K,G;const V={x:B-D.distance.x,y:R-D.distance.y};x&&(V.x=S[0]*Math.round(V.x/S[0]),V.y=S[1]*Math.round(V.y/S[1]));const F=[[h[0][0],h[0][1]],[h[1][0],h[1][1]]];l.current.length>1&&h&&!D.extent&&(F[0][0]=D.positionAbsolute.x-T.x+h[0][0],F[1][0]=D.positionAbsolute.x+((K=D.width)!=null?K:0)-T.x2+h[1][0],F[0][1]=D.positionAbsolute.y-T.y+h[0][1],F[1][1]=D.positionAbsolute.y+((G=D.height)!=null?G:0)-T.y2+h[1][1]);const U=Oi(D,V,z,F,A,I);return v=v||D.position.x!==U.position.x||D.position.y!==U.position.y,D.position=U.position,D.positionAbsolute=U.positionAbsolute,D}),!v)return;k(l.current,!0,!0),u(!0);const P=r?L:Ln(H);if(P&&m.current){const[D,V]=Hn({nodeId:r,dragItems:l.current,nodeInternals:z});P(m.current,D,V)}},$=()=>{var z,L;if(!g.current)return;const[B,R]=oi(y.current,g.current);if(B!==0||R!==0){const{transform:H,panBy:k}=a.getState();f.current.x=((z=f.current.x)!=null?z:0)-B/H[2],f.current.y=((L=f.current.y)!=null?L:0)-R/H[2],k({x:B,y:R})&&M(f.current)}d.current=requestAnimationFrame($)},O=B=>{var A;const{nodeInternals:R,multiSelectionActive:z,nodesDraggable:L,unselectNodesAndEdges:H,onNodeDragStart:k,onSelectionDragStart:h}=a.getState();p.current=!0;const S=r?k:Ln(h);(!s||!i)&&!z&&r&&((A=R.get(r))!=null&&A.selected||H()),r&&i&&s&&to({id:r,store:a,nodeRef:e});const x=N(B);if(f.current=x,l.current=zf(R,L,x,r),S&&l.current){const[I,v]=Hn({nodeId:r,dragItems:l.current,nodeInternals:R});S(B.sourceEvent,I,v)}};if(t)b.on(".drag",null);else{const B=Zc().on("start",R=>{const{domNode:z,nodeDragThreshold:L}=a.getState();L===0&&O(R),_.current=!1;const H=N(R);f.current=H,g.current=(z==null?void 0:z.getBoundingClientRect())||null,y.current=Ve(R.sourceEvent,g.current)}).on("drag",R=>{var k,h,S,x;const z=N(R),{autoPanOnNodeDrag:L,nodeDragThreshold:H}=a.getState();if(R.sourceEvent.type==="touchmove"&&R.sourceEvent.touches.length>1&&(_.current=!0),!_.current){if(!E.current&&p.current&&L&&(E.current=!0,$()),!p.current){const A=z.xSnapped-((h=(k=f==null?void 0:f.current)==null?void 0:k.x)!=null?h:0),I=z.ySnapped-((x=(S=f==null?void 0:f.current)==null?void 0:S.y)!=null?x:0);Math.sqrt(A*A+I*I)>H&&O(R)}(f.current.x!==z.xSnapped||f.current.y!==z.ySnapped)&&l.current&&p.current&&(m.current=R.sourceEvent,y.current=Ve(R.sourceEvent,g.current),M(z))}}).on("end",R=>{if(!(!p.current||_.current)&&(u(!1),E.current=!1,p.current=!1,cancelAnimationFrame(d.current),l.current)){const{updateNodePositions:z,nodeInternals:L,onNodeDragStop:H,onSelectionDragStop:k}=a.getState(),h=r?H:Ln(k);if(z(l.current,!1,!1),h){const[S,x]=Hn({nodeId:r,dragItems:l.current,nodeInternals:L});h(R.sourceEvent,S,x)}}}).filter(R=>{const z=R.target;return!R.button&&(!n||!ur(z,`.${n}`,e))&&(!o||ur(z,o,e))});return b.call(B),()=>{b.on(".drag",null)}}}},[e,t,n,o,i,a,r,s,N]),c}function Li(){const e=ce();return w.useCallback(n=>{const{nodeInternals:o,nodeExtent:r,updateNodePositions:i,getNodes:s,snapToGrid:a,snapGrid:c,onError:u,nodesDraggable:l}=e.getState(),f=s().filter(_=>_.selected&&(_.draggable||l&&typeof _.draggable=="undefined")),d=a?c[0]:5,g=a?c[1]:5,y=n.isShiftPressed?4:1,m=n.x*d*y,E=n.y*g*y,p=f.map(_=>{if(_.positionAbsolute){const N={x:_.positionAbsolute.x+m,y:_.positionAbsolute.y+E};a&&(N.x=c[0]*Math.round(N.x/c[0]),N.y=c[1]*Math.round(N.y/c[1]));const{positionAbsolute:b,position:M}=Oi(_,N,o,r,void 0,u);_.position=M,_.positionAbsolute=b}return _});i(p,!0,!1)},[])}const gt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Ct=e=>{const t=({id:n,type:o,data:r,xPos:i,yPos:s,xPosOrigin:a,yPosOrigin:c,selected:u,onClick:l,onMouseEnter:f,onMouseMove:d,onMouseLeave:g,onContextMenu:y,onDoubleClick:m,style:E,className:p,isDraggable:_,isSelectable:N,isConnectable:b,isFocusable:M,selectNodesOnDrag:$,sourcePosition:O,targetPosition:B,hidden:R,resizeObserver:z,dragHandle:L,zIndex:H,isParent:k,noDragClassName:h,noPanClassName:S,initialized:x,disableKeyboardA11y:A,ariaLabel:I,rfId:v,hasHandleBounds:T})=>{const P=ce(),D=w.useRef(null),V=w.useRef(null),F=w.useRef(O),U=w.useRef(B),K=w.useRef(o),G=N||_||l||f||d||g,j=Li(),ee=Nt(n,P.getState,f),se=Nt(n,P.getState,d),re=Nt(n,P.getState,g),J=Nt(n,P.getState,y),ue=Nt(n,P.getState,m),ae=Q=>{const{nodeDragThreshold:Y}=P.getState();if(N&&(!$||!_||Y>0)&&to({id:n,store:P,nodeRef:D}),l){const he=P.getState().nodeInternals.get(n);he&&l(Q,X({},he))}},te=Q=>{if(!qn(Q)&&!A)if(ai.includes(Q.key)&&N){const Y=Q.key==="Escape";to({id:n,store:P,unselect:Y,nodeRef:D})}else _&&u&&Object.prototype.hasOwnProperty.call(gt,Q.key)&&(P.setState({ariaLiveMessage:`Moved selected node ${Q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~s}`}),j({x:gt[Q.key].x,y:gt[Q.key].y,isShiftPressed:Q.shiftKey}))};w.useEffect(()=>()=>{V.current&&(z==null||z.unobserve(V.current),V.current=null)},[]),w.useEffect(()=>{if(D.current&&!R){const Q=D.current;(!x||!T||V.current!==Q)&&(V.current&&(z==null||z.unobserve(V.current)),z==null||z.observe(Q),V.current=Q)}},[R,x,T]),w.useEffect(()=>{const Q=K.current!==o,Y=F.current!==O,he=U.current!==B;D.current&&(Q||Y||he)&&(Q&&(K.current=o),Y&&(F.current=O),he&&(U.current=B),P.getState().updateNodeDimensions([{id:n,nodeElement:D.current,forceUpdate:!0}]))},[n,o,O,B]);const fe=Hi({nodeRef:D,disabled:R||!_,noDragClassName:h,handleSelector:L,nodeId:n,isSelectable:N,selectNodesOnDrag:$});return R?null:C.createElement("div",{className:de(["react-flow__node",`react-flow__node-${o}`,{[S]:_},p,{selected:u,selectable:N,parent:k,dragging:fe}]),ref:D,style:X({zIndex:H,transform:`translate(${a}px,${c}px)`,pointerEvents:G?"all":"none",visibility:x?"visible":"hidden"},E),"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ee,onMouseMove:se,onMouseLeave:re,onContextMenu:J,onClick:ae,onDoubleClick:ue,onKeyDown:M?te:void 0,tabIndex:M?0:void 0,role:M?"button":void 0,"aria-describedby":A?void 0:`${Ai}-${v}`,"aria-label":I},C.createElement(Ju,{value:n},C.createElement(e,{id:n,data:r,type:o,xPos:i,yPos:s,selected:u,isConnectable:b,sourcePosition:O,targetPosition:B,dragging:fe,dragHandle:L,zIndex:H})))};return t.displayName="NodeWrapper",w.memo(t)};const Lf=e=>{const t=e.getNodes().filter(n=>n.selected);return oe(X({},vn(t,e.nodeOrigin)),{transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive})};function Bf({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=ce(),{width:r,height:i,x:s,y:a,transformString:c,userSelectionActive:u}=ne(Lf,le),l=Li(),f=w.useRef(null);if(w.useEffect(()=>{var y;n||(y=f.current)==null||y.focus({preventScroll:!0})},[n]),Hi({nodeRef:f}),u||!r||!i)return null;const d=e?y=>{const m=o.getState().getNodes().filter(E=>E.selected);e(y,m)}:void 0,g=y=>{Object.prototype.hasOwnProperty.call(gt,y.key)&&l({x:gt[y.key].x,y:gt[y.key].y,isShiftPressed:y.shiftKey})};return C.createElement("div",{className:de(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},C.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:d,tabIndex:n?void 0:-1,onKeyDown:n?void 0:g,style:{width:r,height:i,top:a,left:s}}))}var Vf=w.memo(Bf);const Ff=e=>e.nodesSelectionActive,Bi=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,deleteKeyCode:a,onMove:c,onMoveStart:u,onMoveEnd:l,selectionKeyCode:f,selectionOnDrag:d,selectionMode:g,onSelectionStart:y,onSelectionEnd:m,multiSelectionKeyCode:E,panActivationKeyCode:p,zoomActivationKeyCode:_,elementsSelectable:N,zoomOnScroll:b,zoomOnPinch:M,panOnScroll:$,panOnScrollSpeed:O,panOnScrollMode:B,zoomOnDoubleClick:R,panOnDrag:z,defaultViewport:L,translateExtent:H,minZoom:k,maxZoom:h,preventScrolling:S,onSelectionContextMenu:x,noWheelClassName:A,noPanClassName:I,disableKeyboardA11y:v})=>{const T=ne(Ff),P=Ot(f),D=Ot(p),V=D||z,F=D||$,U=P||d&&V!==!0;return Mf({deleteKeyCode:a,multiSelectionKeyCode:E}),C.createElement($f,{onMove:c,onMoveStart:u,onMoveEnd:l,onPaneContextMenu:i,elementsSelectable:N,zoomOnScroll:b,zoomOnPinch:M,panOnScroll:F,panOnScrollSpeed:O,panOnScrollMode:B,zoomOnDoubleClick:R,panOnDrag:!P&&V,defaultViewport:L,translateExtent:H,minZoom:k,maxZoom:h,zoomActivationKeyCode:_,preventScrolling:S,noWheelClassName:A,noPanClassName:I},C.createElement(Pi,{onSelectionStart:y,onSelectionEnd:m,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:r,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:V,isSelecting:!!U,selectionMode:g},e,T&&C.createElement(Vf,{onSelectionContextMenu:x,noPanClassName:I,disableKeyboardA11y:v})))};Bi.displayName="FlowRenderer";var Xf=w.memo(Bi);function Yf(e){return ne(w.useCallback(n=>e?mi(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Wf(e){const t={input:Ct(e.input||Ei),default:Ct(e.default||eo),output:Ct(e.output||Ci),group:Ct(e.group||xo)},n={},o=Object.keys(e).filter(r=>!["input","default","output","group"].includes(r)).reduce((r,i)=>(r[i]=Ct(e[i]||eo),r),n);return X(X({},t),o)}const Uf=({x:e,y:t,width:n,height:o,origin:r})=>!n||!o?{x:e,y:t}:r[0]<0||r[1]<0||r[0]>1||r[1]>1?{x:e,y:t}:{x:e-n*r[0],y:t-o*r[1]},Gf=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),Vi=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:r,updateNodeDimensions:i,onError:s}=ne(Gf,le),a=Yf(e.onlyRenderVisibleElements),c=w.useRef(),u=w.useMemo(()=>{if(typeof ResizeObserver=="undefined")return null;const l=new ResizeObserver(f=>{const d=f.map(g=>({id:g.target.getAttribute("data-id"),nodeElement:g.target,forceUpdate:!0}));i(d)});return c.current=l,l},[]);return w.useEffect(()=>()=>{var l;(l=c==null?void 0:c.current)==null||l.disconnect()},[]),C.createElement("div",{className:"react-flow__nodes",style:bo},a.map(l=>{var M,$,O,B,R,z,L,H;let f=l.type||"default";e.nodeTypes[f]||(s==null||s("003",Pe.error003(f)),f="default");const d=e.nodeTypes[f]||e.nodeTypes.default,g=!!(l.draggable||t&&typeof l.draggable=="undefined"),y=!!(l.selectable||r&&typeof l.selectable=="undefined"),m=!!(l.connectable||n&&typeof l.connectable=="undefined"),E=!!(l.focusable||o&&typeof l.focusable=="undefined"),p=e.nodeExtent?fo(l.positionAbsolute,e.nodeExtent):l.positionAbsolute,_=(M=p==null?void 0:p.x)!=null?M:0,N=($=p==null?void 0:p.y)!=null?$:0,b=Uf({x:_,y:N,width:(O=l.width)!=null?O:0,height:(B=l.height)!=null?B:0,origin:e.nodeOrigin});return C.createElement(d,{key:l.id,id:l.id,className:l.className,style:l.style,type:f,data:l.data,sourcePosition:l.sourcePosition||W.Bottom,targetPosition:l.targetPosition||W.Top,hidden:l.hidden,xPos:_,yPos:N,xPosOrigin:b.x,yPosOrigin:b.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!l.selected,isDraggable:g,isSelectable:y,isConnectable:m,isFocusable:E,resizeObserver:u,dragHandle:l.dragHandle,zIndex:(z=(R=l[ie])==null?void 0:R.z)!=null?z:0,isParent:!!((L=l[ie])!=null&&L.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!l.width&&!!l.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:l.ariaLabel,hasHandleBounds:!!((H=l[ie])!=null&&H.handleBounds)})}))};Vi.displayName="NodeRenderer";var Kf=w.memo(Vi);const Zf=(e,t,n)=>n===W.Left?e-t:n===W.Right?e+t:e,qf=(e,t,n)=>n===W.Top?e-t:n===W.Bottom?e+t:e,dr="react-flow__edgeupdater",hr=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:r,onMouseEnter:i,onMouseOut:s,type:a})=>C.createElement("circle",{onMouseDown:r,onMouseEnter:i,onMouseOut:s,className:de([dr,`${dr}-${a}`]),cx:Zf(t,o,e),cy:qf(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),jf=()=>!0;var ut=e=>{const t=({id:n,className:o,type:r,data:i,onClick:s,onEdgeDoubleClick:a,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:m,style:E,source:p,target:_,sourceX:N,sourceY:b,targetX:M,targetY:$,sourcePosition:O,targetPosition:B,elementsSelectable:R,hidden:z,sourceHandleId:L,targetHandleId:H,onContextMenu:k,onMouseEnter:h,onMouseMove:S,onMouseLeave:x,reconnectRadius:A,onReconnect:I,onReconnectStart:v,onReconnectEnd:T,markerEnd:P,markerStart:D,rfId:V,ariaLabel:F,isFocusable:U,isReconnectable:K,pathOptions:G,interactionWidth:j,disableKeyboardA11y:ee})=>{const se=w.useRef(null),[re,J]=w.useState(!1),[ue,ae]=w.useState(!1),te=ce(),fe=w.useMemo(()=>`url('#${Jn(D,V)}')`,[D,V]),Q=w.useMemo(()=>`url('#${Jn(P,V)}')`,[P,V]);if(z)return null;const Y=ge=>{var Ne;const{edges:be,addSelectedEdges:We,unselectNodesAndEdges:Ue,multiSelectionActive:Ge}=te.getState(),ke=be.find(bt=>bt.id===n);ke&&(R&&(te.setState({nodesSelectionActive:!1}),ke.selected&&Ge?(Ue({nodes:[],edges:[ke]}),(Ne=se.current)==null||Ne.blur()):We([n])),s&&s(ge,ke))},he=Et(n,te.getState,a),Ae=Et(n,te.getState,k),Fe=Et(n,te.getState,h),ze=Et(n,te.getState,S),nt=Et(n,te.getState,x),Te=(ge,be)=>{if(ge.button!==0)return;const{edges:We,isValidConnection:Ue}=te.getState(),Ge=be?_:p,ke=(be?H:L)||null,Ne=be?"target":"source",bt=Ue||jf,_n=be,vt=We.find(Ke=>Ke.id===n);ae(!0),v==null||v(ge,vt,Ne);const Sn=Ke=>{ae(!1),T==null||T(Ke,vt,Ne)};bi({event:ge,handleId:ke,nodeId:Ge,onConnect:Ke=>I==null?void 0:I(vt,Ke),isTarget:_n,getState:te.getState,setState:te.setState,isValidConnection:bt,edgeUpdaterType:Ne,onReconnectEnd:Sn})},ot=ge=>Te(ge,!0),Xe=ge=>Te(ge,!1),Ye=()=>J(!0),rt=()=>J(!1),it=!R&&!s,wt=ge=>{var be;if(!ee&&ai.includes(ge.key)&&R){const{unselectNodesAndEdges:We,addSelectedEdges:Ue,edges:Ge}=te.getState();ge.key==="Escape"?((be=se.current)==null||be.blur(),We({edges:[Ge.find(Ne=>Ne.id===n)]})):Ue([n])}};return C.createElement("g",{className:de(["react-flow__edge",`react-flow__edge-${r}`,o,{selected:c,animated:u,inactive:it,updating:re}]),onClick:Y,onDoubleClick:he,onContextMenu:Ae,onMouseEnter:Fe,onMouseMove:ze,onMouseLeave:nt,onKeyDown:U?wt:void 0,tabIndex:U?0:void 0,role:U?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":F===null?void 0:F||`Edge from ${p} to ${_}`,"aria-describedby":U?`${Ti}-${V}`:void 0,ref:se},!ue&&C.createElement(e,{id:n,source:p,target:_,selected:c,animated:u,label:l,labelStyle:f,labelShowBg:d,labelBgStyle:g,labelBgPadding:y,labelBgBorderRadius:m,data:i,style:E,sourceX:N,sourceY:b,targetX:M,targetY:$,sourcePosition:O,targetPosition:B,sourceHandleId:L,targetHandleId:H,markerStart:fe,markerEnd:Q,pathOptions:G,interactionWidth:j}),K&&C.createElement(C.Fragment,null,(K==="source"||K===!0)&&C.createElement(hr,{position:O,centerX:N,centerY:b,radius:A,onMouseDown:ot,onMouseEnter:Ye,onMouseOut:rt,type:"source"}),(K==="target"||K===!0)&&C.createElement(hr,{position:B,centerX:M,centerY:$,radius:A,onMouseDown:Xe,onMouseEnter:Ye,onMouseOut:rt,type:"target"})))};return t.displayName="EdgeWrapper",w.memo(t)};function Jf(e){const t={default:ut(e.default||dn),straight:ut(e.bezier||mo),step:ut(e.step||go),smoothstep:ut(e.step||bn),simplebezier:ut(e.simplebezier||ho)},n={},o=Object.keys(e).filter(r=>!["default","bezier"].includes(r)).reduce((r,i)=>(r[i]=ut(e[i]||dn),r),n);return X(X({},t),o)}function gr(e,t,n=null){const o=((n==null?void 0:n.x)||0)+t.x,r=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,s=(n==null?void 0:n.height)||t.height;switch(e){case W.Top:return{x:o+i/2,y:r};case W.Right:return{x:o+i,y:r+s/2};case W.Bottom:return{x:o+i/2,y:r+s};case W.Left:return{x:o,y:r+s/2}}}function mr(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Qf=(e,t,n,o,r,i)=>{const s=gr(n,e,t),a=gr(i,o,r);return{sourceX:s.x,sourceY:s.y,targetX:a.x,targetY:a.y}};function ed({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:r,targetHeight:i,width:s,height:a,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+r),y2:Math.max(e.y+o,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const l=Pt({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:s/c[2],height:a/c[2]}),f=Math.max(0,Math.min(l.x2,u.x2)-Math.max(l.x,u.x)),d=Math.max(0,Math.min(l.y2,u.y2)-Math.max(l.y,u.y));return Math.ceil(f*d)>0}function pr(e){var o,r,i,s,a;const t=((o=e==null?void 0:e[ie])==null?void 0:o.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((r=e==null?void 0:e.positionAbsolute)==null?void 0:r.x)!="undefined"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)!="undefined";return[{x:((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const td=[{level:0,isMaxLevel:!0,edges:[]}];function nd(e,t,n=!1){let o=-1;const r=e.reduce((s,a)=>{var l,f;const c=we(a.zIndex);let u=c?a.zIndex:0;if(n){const d=t.get(a.target),g=t.get(a.source),y=a.selected||(d==null?void 0:d.selected)||(g==null?void 0:g.selected),m=Math.max(((l=g==null?void 0:g[ie])==null?void 0:l.z)||0,((f=d==null?void 0:d[ie])==null?void 0:f.z)||0,1e3);u=(c?a.zIndex:0)+(y?m:0)}return s[u]?s[u].push(a):s[u]=[a],o=u>o?u:o,s},{}),i=Object.entries(r).map(([s,a])=>{const c=+s;return{edges:a,level:c,isMaxLevel:c===o}});return i.length===0?td:i}function od(e,t,n){const o=ne(w.useCallback(r=>e?r.edges.filter(i=>{const s=t.get(i.source),a=t.get(i.target);return(s==null?void 0:s.width)&&(s==null?void 0:s.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&ed({sourcePos:s.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:s.width,sourceHeight:s.height,targetWidth:a.width,targetHeight:a.height,width:r.width,height:r.height,transform:r.transform})}):r.edges,[e,t]));return nd(o,t,n)}const rd=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),id=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),yr={[fn.Arrow]:rd,[fn.ArrowClosed]:id};function sd(e){const t=ce();return w.useMemo(()=>{var r,i;return Object.prototype.hasOwnProperty.call(yr,e)?yr[e]:((i=(r=t.getState()).onError)==null||i.call(r,"009",Pe.error009(e)),null)},[e])}const ad=({id:e,type:t,color:n,width:o=12.5,height:r=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=sd(t);return c?C.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${r}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},C.createElement(c,{color:n,strokeWidth:s})):null},cd=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((r,i)=>([i.markerStart,i.markerEnd].forEach(s=>{if(s&&typeof s=="object"){const a=Jn(s,t);o.includes(a)||(r.push(X({id:a,color:s.color||e},s)),o.push(a))}}),r),[]).sort((r,i)=>r.id.localeCompare(i.id))},Fi=({defaultColor:e,rfId:t})=>{const n=ne(w.useCallback(cd({defaultColor:e,rfId:t}),[e,t]),(o,r)=>!(o.length!==r.length||o.some((i,s)=>i.id!==r[s].id)));return C.createElement("defs",null,n.map(o=>C.createElement(ad,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};Fi.displayName="MarkerDefinitions";var ld=w.memo(Fi);const ud=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Xi=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:r,noPanClassName:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:l,onEdgeDoubleClick:f,onReconnect:d,onReconnectStart:g,onReconnectEnd:y,reconnectRadius:m,children:E,disableKeyboardA11y:p})=>{const{edgesFocusable:_,edgesUpdatable:N,elementsSelectable:b,width:M,height:$,connectionMode:O,nodeInternals:B,onError:R}=ne(ud,le),z=od(t,B,n);return M?C.createElement(C.Fragment,null,z.map(({level:L,edges:H,isMaxLevel:k})=>C.createElement("svg",{key:L,style:{zIndex:L},width:M,height:$,className:"react-flow__edges react-flow__container"},k&&C.createElement(ld,{defaultColor:e,rfId:o}),C.createElement("g",null,H.map(h=>{var te,fe;const[S,x,A]=pr(B.get(h.source)),[I,v,T]=pr(B.get(h.target));if(!A||!T)return null;let P=h.type||"default";r[P]||(R==null||R("011",Pe.error011(P)),P="default");const D=r[P]||r.default,V=O===tt.Strict?v.target:((te=v.target)!=null?te:[]).concat((fe=v.source)!=null?fe:[]),F=mr(x.source,h.sourceHandle),U=mr(V,h.targetHandle),K=(F==null?void 0:F.position)||W.Bottom,G=(U==null?void 0:U.position)||W.Top,j=!!(h.focusable||_&&typeof h.focusable=="undefined"),ee=h.reconnectable||h.updatable,se=typeof d!="undefined"&&(ee||N&&typeof ee=="undefined");if(!F||!U)return R==null||R("008",Pe.error008(F,h)),null;const{sourceX:re,sourceY:J,targetX:ue,targetY:ae}=Qf(S,F,K,I,U,G);return C.createElement(D,{key:h.id,id:h.id,className:de([h.className,i]),type:P,data:h.data,selected:!!h.selected,animated:!!h.animated,hidden:!!h.hidden,label:h.label,labelStyle:h.labelStyle,labelShowBg:h.labelShowBg,labelBgStyle:h.labelBgStyle,labelBgPadding:h.labelBgPadding,labelBgBorderRadius:h.labelBgBorderRadius,style:h.style,source:h.source,target:h.target,sourceHandleId:h.sourceHandle,targetHandleId:h.targetHandle,markerEnd:h.markerEnd,markerStart:h.markerStart,sourceX:re,sourceY:J,targetX:ue,targetY:ae,sourcePosition:K,targetPosition:G,elementsSelectable:b,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:u,onClick:l,onEdgeDoubleClick:f,onReconnect:d,onReconnectStart:g,onReconnectEnd:y,reconnectRadius:m,rfId:o,ariaLabel:h.ariaLabel,isFocusable:j,isReconnectable:se,pathOptions:"pathOptions"in h?h.pathOptions:void 0,interactionWidth:h.interactionWidth,disableKeyboardA11y:p})})))),E):null};Xi.displayName="EdgeRenderer";var fd=w.memo(Xi);const dd=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function hd({children:e}){const t=ne(dd);return C.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function gd(e){const t=wo(),n=w.useRef(!1);w.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const md={[W.Left]:W.Right,[W.Right]:W.Left,[W.Top]:W.Bottom,[W.Bottom]:W.Top},Yi=({nodeId:e,handleType:t,style:n,type:o=Be.Bezier,CustomComponent:r,connectionStatus:i})=>{var $,O,B,R,z,L,H;const{fromNode:s,handleId:a,toX:c,toY:u,connectionMode:l}=ne(w.useCallback(k=>({fromNode:k.nodeInternals.get(e),handleId:k.connectionHandleId,toX:(k.connectionPosition.x-k.transform[0])/k.transform[2],toY:(k.connectionPosition.y-k.transform[1])/k.transform[2],connectionMode:k.connectionMode}),[e]),le),f=($=s==null?void 0:s[ie])==null?void 0:$.handleBounds;let d=f==null?void 0:f[t];if(l===tt.Loose&&(d=d||(f==null?void 0:f[t==="source"?"target":"source"])),!s||!d)return null;const g=a?d.find(k=>k.id===a):d[0],y=g?g.x+g.width/2:((O=s.width)!=null?O:0)/2,m=g?g.y+g.height/2:(B=s.height)!=null?B:0,E=((z=(R=s.positionAbsolute)==null?void 0:R.x)!=null?z:0)+y,p=((H=(L=s.positionAbsolute)==null?void 0:L.y)!=null?H:0)+m,_=g==null?void 0:g.position,N=_?md[_]:null;if(!_||!N)return null;if(r)return C.createElement(r,{connectionLineType:o,connectionLineStyle:n,fromNode:s,fromHandle:g,fromX:E,fromY:p,toX:c,toY:u,fromPosition:_,toPosition:N,connectionStatus:i});let b="";const M={sourceX:E,sourceY:p,sourcePosition:_,targetX:c,targetY:u,targetPosition:N};return o===Be.Bezier?[b]=di(M):o===Be.Step?[b]=jn(oe(X({},M),{borderRadius:0})):o===Be.SmoothStep?[b]=jn(M):o===Be.SimpleBezier?[b]=fi(M):b=`M${E},${p} ${c},${u}`,C.createElement("path",{d:b,fill:"none",className:"react-flow__connection-path",style:n})};Yi.displayName="ConnectionLine";const pd=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function yd({containerStyle:e,style:t,type:n,component:o}){const{nodeId:r,handleType:i,nodesConnectable:s,width:a,height:c,connectionStatus:u}=ne(pd,le);return!(r&&i&&a&&s)?null:C.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},C.createElement("g",{className:de(["react-flow__connection",u])},C.createElement(Yi,{nodeId:r,handleType:i,style:t,type:n,CustomComponent:o,connectionStatus:u})))}function xr(e,t){return w.useRef(null),ce(),w.useMemo(()=>t(e),[e])}const Wi=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:r,onInit:i,onNodeClick:s,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:g,onSelectionContextMenu:y,onSelectionStart:m,onSelectionEnd:E,connectionLineType:p,connectionLineStyle:_,connectionLineComponent:N,connectionLineContainerStyle:b,selectionKeyCode:M,selectionOnDrag:$,selectionMode:O,multiSelectionKeyCode:B,panActivationKeyCode:R,zoomActivationKeyCode:z,deleteKeyCode:L,onlyRenderVisibleElements:H,elementsSelectable:k,selectNodesOnDrag:h,defaultViewport:S,translateExtent:x,minZoom:A,maxZoom:I,preventScrolling:v,defaultMarkerColor:T,zoomOnScroll:P,zoomOnPinch:D,panOnScroll:V,panOnScrollSpeed:F,panOnScrollMode:U,zoomOnDoubleClick:K,panOnDrag:G,onPaneClick:j,onPaneMouseEnter:ee,onPaneMouseMove:se,onPaneMouseLeave:re,onPaneScroll:J,onPaneContextMenu:ue,onEdgeContextMenu:ae,onEdgeMouseEnter:te,onEdgeMouseMove:fe,onEdgeMouseLeave:Q,onReconnect:Y,onReconnectStart:he,onReconnectEnd:Ae,reconnectRadius:Fe,noDragClassName:ze,noWheelClassName:nt,noPanClassName:Te,elevateEdgesOnSelect:ot,disableKeyboardA11y:Xe,nodeOrigin:Ye,nodeExtent:rt,rfId:it})=>{const wt=xr(e,Wf),ge=xr(t,Jf);return gd(i),C.createElement(Xf,{onPaneClick:j,onPaneMouseEnter:ee,onPaneMouseMove:se,onPaneMouseLeave:re,onPaneContextMenu:ue,onPaneScroll:J,deleteKeyCode:L,selectionKeyCode:M,selectionOnDrag:$,selectionMode:O,onSelectionStart:m,onSelectionEnd:E,multiSelectionKeyCode:B,panActivationKeyCode:R,zoomActivationKeyCode:z,elementsSelectable:k,onMove:n,onMoveStart:o,onMoveEnd:r,zoomOnScroll:P,zoomOnPinch:D,zoomOnDoubleClick:K,panOnScroll:V,panOnScrollSpeed:F,panOnScrollMode:U,panOnDrag:G,defaultViewport:S,translateExtent:x,minZoom:A,maxZoom:I,onSelectionContextMenu:y,preventScrolling:v,noDragClassName:ze,noWheelClassName:nt,noPanClassName:Te,disableKeyboardA11y:Xe},C.createElement(hd,null,C.createElement(fd,{edgeTypes:ge,onEdgeClick:a,onEdgeDoubleClick:u,onlyRenderVisibleElements:H,onEdgeContextMenu:ae,onEdgeMouseEnter:te,onEdgeMouseMove:fe,onEdgeMouseLeave:Q,onReconnect:Y,onReconnectStart:he,onReconnectEnd:Ae,reconnectRadius:Fe,defaultMarkerColor:T,noPanClassName:Te,elevateEdgesOnSelect:!!ot,disableKeyboardA11y:Xe,rfId:it},C.createElement(yd,{style:_,type:p,component:N,containerStyle:b})),C.createElement("div",{className:"react-flow__edgelabel-renderer"}),C.createElement(Kf,{nodeTypes:wt,onNodeClick:s,onNodeDoubleClick:c,onNodeMouseEnter:l,onNodeMouseMove:f,onNodeMouseLeave:d,onNodeContextMenu:g,selectNodesOnDrag:h,onlyRenderVisibleElements:H,noPanClassName:Te,noDragClassName:ze,disableKeyboardA11y:Xe,nodeOrigin:Ye,nodeExtent:rt,rfId:it})))};Wi.displayName="GraphView";var xd=w.memo(Wi);const no=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Oe={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:no,nodeExtent:no,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:tt.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Uu,isValidConnection:void 0},wd=()=>aa((e,t)=>oe(X({},Oe),{setNodes:n=>{const{nodeInternals:o,nodeOrigin:r,elevateNodesOnSelect:i}=t();e({nodeInternals:zn(n,o,r,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(r=>X(X({},o),r))})},setDefaultNodesAndEdges:(n,o)=>{const r=typeof n!="undefined",i=typeof o!="undefined",s=r?zn(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:s,edges:i?o:[],hasDefaultNodes:r,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:r,fitViewOnInit:i,fitViewOnInitDone:s,fitViewOnInitOptions:a,domNode:c,nodeOrigin:u}=t(),l=c==null?void 0:c.querySelector(".react-flow__viewport");if(!l)return;const f=window.getComputedStyle(l),{m22:d}=new window.DOMMatrixReadOnly(f.transform),g=n.reduce((m,E)=>{const p=r.get(E.id);if(p!=null&&p.hidden)r.set(p.id,oe(X({},p),{[ie]:oe(X({},p[ie]),{handleBounds:void 0})}));else if(p){const _=uo(E.nodeElement);!!(_.width&&_.height&&(p.width!==_.width||p.height!==_.height||E.forceUpdate))&&(r.set(p.id,X(oe(X({},p),{[ie]:oe(X({},p[ie]),{handleBounds:{source:fr(".source",E.nodeElement,d,u),target:fr(".target",E.nodeElement,d,u)}})}),_)),m.push({id:p.id,type:"dimensions",dimensions:_}))}return m},[]);$i(r,u);const y=s||i&&!s&&Ri(t,X({initial:!0},a));e({nodeInternals:new Map(r),fitViewOnInitDone:y}),(g==null?void 0:g.length)>0&&(o==null||o(g))},updateNodePositions:(n,o=!0,r=!1)=>{const{triggerNodeChanges:i}=t(),s=n.map(a=>{const c={id:a.id,type:"position",dragging:r};return o&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});i(s)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:r,hasDefaultNodes:i,nodeOrigin:s,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(i){const u=Di(n,a()),l=zn(u,r,s,c);e({nodeInternals:l})}o==null||o(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:r,getNodes:i}=t();let s,a=null;o?s=n.map(c=>Le(c,!0)):(s=ft(i(),n),a=ft(r,[])),Zt({changedNodes:s,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:r,getNodes:i}=t();let s,a=null;o?s=n.map(c=>Le(c,!0)):(s=ft(r,n),a=ft(i(),[])),Zt({changedNodes:a,changedEdges:s,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:r,getNodes:i}=t(),s=n||i(),a=o||r,c=s.map(l=>(l.selected=!1,Le(l.id,!1))),u=a.map(l=>Le(l.id,!1));Zt({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:r}=t();o==null||o.scaleExtent([n,r]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:r}=t();o==null||o.scaleExtent([r,n]),e({maxZoom:n})},setTranslateExtent:n=>{var o;(o=t().d3Zoom)==null||o.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),i=o().filter(a=>a.selected).map(a=>Le(a.id,!1)),s=n.filter(a=>a.selected).map(a=>Le(a.id,!1));Zt({changedNodes:i,changedEdges:s,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(r=>{r.positionAbsolute=fo(r.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:r,height:i,d3Zoom:s,d3Selection:a,translateExtent:c}=t();if(!s||!a||!n.x&&!n.y)return!1;const u=Ie.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),l=[[0,0],[r,i]],f=s==null?void 0:s.constrain()(u,l,c);return s.transform(a,f),o[0]!==f.x||o[1]!==f.y||o[2]!==f.k},cancelConnection:()=>e({connectionNodeId:Oe.connectionNodeId,connectionHandleId:Oe.connectionHandleId,connectionHandleType:Oe.connectionHandleType,connectionStatus:Oe.connectionStatus,connectionStartHandle:Oe.connectionStartHandle,connectionEndHandle:Oe.connectionEndHandle}),reset:()=>e(X({},Oe))}),Object.is),Ui=({children:e})=>{const t=w.useRef(null);return t.current||(t.current=wd()),C.createElement(Lu,{value:t.current},e)};Ui.displayName="ReactFlowProvider";const Gi=({children:e})=>w.useContext(wn)?C.createElement(C.Fragment,null,e):C.createElement(Ui,null,e);Gi.displayName="ReactFlowWrapper";const bd={input:Ei,default:eo,output:Ci,group:xo},vd={default:dn,straight:mo,step:go,smoothstep:bn,simplebezier:ho},_d=[0,0],Sd=[15,15],Ed={x:0,y:0,zoom:1},Nd={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Ki=w.forwardRef((mh,Ts)=>{var No=mh,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:r,nodeTypes:i=bd,edgeTypes:s=vd,onNodeClick:a,onEdgeClick:c,onInit:u,onMove:l,onMoveStart:f,onMoveEnd:d,onConnect:g,onConnectStart:y,onConnectEnd:m,onClickConnectStart:E,onClickConnectEnd:p,onNodeMouseEnter:_,onNodeMouseMove:N,onNodeMouseLeave:b,onNodeContextMenu:M,onNodeDoubleClick:$,onNodeDragStart:O,onNodeDrag:B,onNodeDragStop:R,onNodesDelete:z,onEdgesDelete:L,onSelectionChange:H,onSelectionDragStart:k,onSelectionDrag:h,onSelectionDragStop:S,onSelectionContextMenu:x,onSelectionStart:A,onSelectionEnd:I,connectionMode:v=tt.Strict,connectionLineType:T=Be.Bezier,connectionLineStyle:P,connectionLineComponent:D,connectionLineContainerStyle:V,deleteKeyCode:F="Backspace",selectionKeyCode:U="Shift",selectionOnDrag:K=!1,selectionMode:G=zt.Full,panActivationKeyCode:j="Space",multiSelectionKeyCode:ee=un()?"Meta":"Control",zoomActivationKeyCode:se=un()?"Meta":"Control",snapToGrid:re=!1,snapGrid:J=Sd,onlyRenderVisibleElements:ue=!1,selectNodesOnDrag:ae=!0,nodesDraggable:te,nodesConnectable:fe,nodesFocusable:Q,nodeOrigin:Y=_d,edgesFocusable:he,edgesUpdatable:Ae,elementsSelectable:Fe,defaultViewport:ze=Ed,minZoom:nt=.5,maxZoom:Te=2,translateExtent:ot=no,preventScrolling:Xe=!0,nodeExtent:Ye,defaultMarkerColor:rt="#b1b1b7",zoomOnScroll:it=!0,zoomOnPinch:wt=!0,panOnScroll:ge=!1,panOnScrollSpeed:be=.5,panOnScrollMode:We=je.Free,zoomOnDoubleClick:Ue=!0,panOnDrag:Ge=!0,onPaneClick:ke,onPaneMouseEnter:Ne,onPaneMouseMove:bt,onPaneMouseLeave:_n,onPaneScroll:vt,onPaneContextMenu:Sn,children:vo,onEdgeContextMenu:Ke,onEdgeDoubleClick:ts,onEdgeMouseEnter:ns,onEdgeMouseMove:os,onEdgeMouseLeave:rs,onEdgeUpdate:is,onEdgeUpdateStart:ss,onEdgeUpdateEnd:as,onReconnect:En,onReconnectStart:Nn,onReconnectEnd:Cn,reconnectRadius:Mn=10,edgeUpdaterRadius:cs=10,onNodesChange:ls,onEdgesChange:us,noDragClassName:fs="nodrag",noWheelClassName:ds="nowheel",noPanClassName:_o="nopan",fitView:hs=!1,fitViewOptions:gs,connectOnClick:ms=!0,attributionPosition:ps,proOptions:ys,defaultEdgeOptions:xs,elevateNodesOnSelect:ws=!0,elevateEdgesOnSelect:bs=!1,disableKeyboardA11y:So=!1,autoPanOnConnect:vs=!0,autoPanOnNodeDrag:_s=!0,connectionRadius:Ss=20,isValidConnection:Es,onError:Ns,style:Cs,id:Eo,nodeDragThreshold:Ms}=No,As=st(No,["nodes","edges","defaultNodes","defaultEdges","className","nodeTypes","edgeTypes","onNodeClick","onEdgeClick","onInit","onMove","onMoveStart","onMoveEnd","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","onNodeMouseEnter","onNodeMouseMove","onNodeMouseLeave","onNodeContextMenu","onNodeDoubleClick","onNodeDragStart","onNodeDrag","onNodeDragStop","onNodesDelete","onEdgesDelete","onSelectionChange","onSelectionDragStart","onSelectionDrag","onSelectionDragStop","onSelectionContextMenu","onSelectionStart","onSelectionEnd","connectionMode","connectionLineType","connectionLineStyle","connectionLineComponent","connectionLineContainerStyle","deleteKeyCode","selectionKeyCode","selectionOnDrag","selectionMode","panActivationKeyCode","multiSelectionKeyCode","zoomActivationKeyCode","snapToGrid","snapGrid","onlyRenderVisibleElements","selectNodesOnDrag","nodesDraggable","nodesConnectable","nodesFocusable","nodeOrigin","edgesFocusable","edgesUpdatable","elementsSelectable","defaultViewport","minZoom","maxZoom","translateExtent","preventScrolling","nodeExtent","defaultMarkerColor","zoomOnScroll","zoomOnPinch","panOnScroll","panOnScrollSpeed","panOnScrollMode","zoomOnDoubleClick","panOnDrag","onPaneClick","onPaneMouseEnter","onPaneMouseMove","onPaneMouseLeave","onPaneScroll","onPaneContextMenu","children","onEdgeContextMenu","onEdgeDoubleClick","onEdgeMouseEnter","onEdgeMouseMove","onEdgeMouseLeave","onEdgeUpdate","onEdgeUpdateStart","onEdgeUpdateEnd","onReconnect","onReconnectStart","onReconnectEnd","reconnectRadius","edgeUpdaterRadius","onNodesChange","onEdgesChange","noDragClassName","noWheelClassName","noPanClassName","fitView","fitViewOptions","connectOnClick","attributionPosition","proOptions","defaultEdgeOptions","elevateNodesOnSelect","elevateEdgesOnSelect","disableKeyboardA11y","autoPanOnConnect","autoPanOnNodeDrag","connectionRadius","isValidConnection","onError","style","id","nodeDragThreshold"]);const An=Eo||"1";return C.createElement("div",oe(X({},As),{style:X(X({},Cs),Nd),ref:Ts,className:de(["react-flow",r]),"data-testid":"rf__wrapper",id:Eo}),C.createElement(Gi,null,C.createElement(xd,{onInit:u,onMove:l,onMoveStart:f,onMoveEnd:d,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:_,onNodeMouseMove:N,onNodeMouseLeave:b,onNodeContextMenu:M,onNodeDoubleClick:$,nodeTypes:i,edgeTypes:s,connectionLineType:T,connectionLineStyle:P,connectionLineComponent:D,connectionLineContainerStyle:V,selectionKeyCode:U,selectionOnDrag:K,selectionMode:G,deleteKeyCode:F,multiSelectionKeyCode:ee,panActivationKeyCode:j,zoomActivationKeyCode:se,onlyRenderVisibleElements:ue,selectNodesOnDrag:ae,defaultViewport:ze,translateExtent:ot,minZoom:nt,maxZoom:Te,preventScrolling:Xe,zoomOnScroll:it,zoomOnPinch:wt,zoomOnDoubleClick:Ue,panOnScroll:ge,panOnScrollSpeed:be,panOnScrollMode:We,panOnDrag:Ge,onPaneClick:ke,onPaneMouseEnter:Ne,onPaneMouseMove:bt,onPaneMouseLeave:_n,onPaneScroll:vt,onPaneContextMenu:Sn,onSelectionContextMenu:x,onSelectionStart:A,onSelectionEnd:I,onEdgeContextMenu:Ke,onEdgeDoubleClick:ts,onEdgeMouseEnter:ns,onEdgeMouseMove:os,onEdgeMouseLeave:rs,onReconnect:En!=null?En:is,onReconnectStart:Nn!=null?Nn:ss,onReconnectEnd:Cn!=null?Cn:as,reconnectRadius:Mn!=null?Mn:cs,defaultMarkerColor:rt,noDragClassName:fs,noWheelClassName:ds,noPanClassName:_o,elevateEdgesOnSelect:bs,rfId:An,disableKeyboardA11y:So,nodeOrigin:Y,nodeExtent:Ye}),C.createElement(mf,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:g,onConnectStart:y,onConnectEnd:m,onClickConnectStart:E,onClickConnectEnd:p,nodesDraggable:te,nodesConnectable:fe,nodesFocusable:Q,edgesFocusable:he,edgesUpdatable:Ae,elementsSelectable:Fe,elevateNodesOnSelect:ws,minZoom:nt,maxZoom:Te,nodeExtent:Ye,onNodesChange:ls,onEdgesChange:us,snapToGrid:re,snapGrid:J,connectionMode:v,translateExtent:ot,connectOnClick:ms,defaultEdgeOptions:xs,fitView:hs,fitViewOptions:gs,onNodesDelete:z,onEdgesDelete:L,onNodeDragStart:O,onNodeDrag:B,onNodeDragStop:R,onSelectionDrag:h,onSelectionDragStart:k,onSelectionDragStop:S,noPanClassName:_o,nodeOrigin:Y,rfId:An,autoPanOnConnect:vs,autoPanOnNodeDrag:_s,onError:Ns,connectionRadius:Ss,isValidConnection:Es,nodeDragThreshold:Ms}),C.createElement(hf,{onSelectionChange:H}),vo,C.createElement(Vu,{proOptions:ys,position:ps}),C.createElement(bf,{rfId:An,disableKeyboardA11y:So})))});Ki.displayName="ReactFlow";function Zi(e){return t=>{const[n,o]=w.useState(t),r=w.useCallback(i=>o(s=>e(i,s)),[]);return[n,o,r]}}const Cd=Zi(Di),Md=Zi(Df),qi=({id:e,x:t,y:n,width:o,height:r,style:i,color:s,strokeColor:a,strokeWidth:c,className:u,borderRadius:l,shapeRendering:f,onClick:d,selected:g})=>{const{background:y,backgroundColor:m}=i||{},E=s||y||m;return C.createElement("rect",{className:de(["react-flow__minimap-node",{selected:g},u]),x:t,y:n,rx:l,ry:l,width:o,height:r,fill:E,stroke:a,strokeWidth:c,shapeRendering:f,onClick:d?p=>d(p,e):void 0})};qi.displayName="MiniMapNode";var Ad=w.memo(qi);const Td=e=>e.nodeOrigin,kd=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),Bn=e=>e instanceof Function?e:()=>e;function $d({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r=2,nodeComponent:i=Ad,onClick:s}){const a=ne(kd,le),c=ne(Td),u=Bn(t),l=Bn(e),f=Bn(n),d=typeof window=="undefined"||window.chrome?"crispEdges":"geometricPrecision";return C.createElement(C.Fragment,null,a.map(g=>{const{x:y,y:m}=Qe(g,c).positionAbsolute;return C.createElement(i,{key:g.id,x:y,y:m,width:g.width,height:g.height,style:g.style,selected:g.selected,className:f(g),color:u(g),borderRadius:o,strokeColor:l(g),strokeWidth:r,shapeRendering:d,onClick:s,id:g.id})}))}var Rd=w.memo($d);const Id=200,Dd=150,Pd=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?Yu(vn(t,e.nodeOrigin),n):n,rfId:e.rfId}},zd="react-flow__minimap-desc";function ji({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:o="#e2e2e2",nodeClassName:r="",nodeBorderRadius:i=5,nodeStrokeWidth:s=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:l=1,position:f="bottom-right",onClick:d,onNodeClick:g,pannable:y=!1,zoomable:m=!1,ariaLabel:E="React Flow mini map",inversePan:p=!1,zoomStep:_=10,offsetScale:N=5}){var U,K;const b=ce(),M=w.useRef(null),{boundingRect:$,viewBB:O,rfId:B}=ne(Pd,le),R=(U=e==null?void 0:e.width)!=null?U:Id,z=(K=e==null?void 0:e.height)!=null?K:Dd,L=$.width/R,H=$.height/z,k=Math.max(L,H),h=k*R,S=k*z,x=N*k,A=$.x-(h-$.width)/2-x,I=$.y-(S-$.height)/2-x,v=h+x*2,T=S+x*2,P=`${zd}-${B}`,D=w.useRef(0);D.current=k,w.useEffect(()=>{if(M.current){const G=xe(M.current),j=re=>{const{transform:J,d3Selection:ue,d3Zoom:ae}=b.getState();if(re.sourceEvent.type!=="wheel"||!ue||!ae)return;const te=-re.sourceEvent.deltaY*(re.sourceEvent.deltaMode===1?.05:re.sourceEvent.deltaMode?1:.002)*_,fe=J[2]*Math.pow(2,te);ae.scaleTo(ue,fe)},ee=re=>{const{transform:J,d3Selection:ue,d3Zoom:ae,translateExtent:te,width:fe,height:Q}=b.getState();if(re.sourceEvent.type!=="mousemove"||!ue||!ae)return;const Y=D.current*Math.max(1,J[2])*(p?-1:1),he={x:J[0]-re.sourceEvent.movementX*Y,y:J[1]-re.sourceEvent.movementY*Y},Ae=[[0,0],[fe,Q]],Fe=Ie.translate(he.x,he.y).scale(J[2]),ze=ae.constrain()(Fe,Ae,te);ae.transform(ue,ze)},se=ti().on("zoom",y?ee:null).on("zoom.wheel",m?j:null);return G.call(se),()=>{G.on("zoom",null)}}},[y,m,p,_]);const V=d?G=>{const j=ve(G);d(G,{x:j[0],y:j[1]})}:void 0,F=g?(G,j)=>{const ee=b.getState().nodeInternals.get(j);g(G,ee)}:void 0;return C.createElement(lo,{position:f,style:e,className:de(["react-flow__minimap",t]),"data-testid":"rf__minimap"},C.createElement("svg",{width:R,height:z,viewBox:`${A} ${I} ${v} ${T}`,role:"img","aria-labelledby":P,ref:M,onClick:V},E&&C.createElement("title",{id:P},E),C.createElement(Rd,{onClick:F,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:r,nodeStrokeWidth:s,nodeComponent:a}),C.createElement("path",{className:"react-flow__minimap-mask",d:`M${A-x},${I-x}h${v+x*2}v${T+x*2}h${-v-x*2}z
        M${O.x},${O.y}h${O.width}v${O.height}h${-O.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:l,pointerEvents:"none"})))}ji.displayName="MiniMap";var Od=w.memo(ji);function Hd(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},C.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Ld(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},C.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Bd(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},C.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Vd(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Fd(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Tt=o=>{var r=o,{children:e,className:t}=r,n=st(r,["children","className"]);return C.createElement("button",X({type:"button",className:de(["react-flow__controls-button",t])},n),e)};Tt.displayName="ControlButton";const Xd=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Ji=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:r,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:u,children:l,position:f="bottom-left"})=>{const d=ce(),[g,y]=w.useState(!1),{isInteractive:m,minZoomReached:E,maxZoomReached:p}=ne(Xd,le),{zoomIn:_,zoomOut:N,fitView:b}=wo();if(w.useEffect(()=>{y(!0)},[]),!g)return null;const M=()=>{_(),i==null||i()},$=()=>{N(),s==null||s()},O=()=>{b(r),a==null||a()},B=()=>{d.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)};return C.createElement(lo,{className:de(["react-flow__controls",u]),position:f,style:e,"data-testid":"rf__controls"},t&&C.createElement(C.Fragment,null,C.createElement(Tt,{onClick:M,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:p},C.createElement(Hd,null)),C.createElement(Tt,{onClick:$,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:E},C.createElement(Ld,null))),n&&C.createElement(Tt,{className:"react-flow__controls-fitview",onClick:O,title:"fit view","aria-label":"fit view"},C.createElement(Bd,null)),o&&C.createElement(Tt,{className:"react-flow__controls-interactive",onClick:B,title:"toggle interactivity","aria-label":"toggle interactivity"},m?C.createElement(Fd,null):C.createElement(Vd,null)),l)};Ji.displayName="Controls";var Yd=w.memo(Ji),Se;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Se||(Se={}));function Wd({color:e,dimensions:t,lineWidth:n}){return C.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Ud({color:e,radius:t}){return C.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const Gd={[Se.Dots]:"#91919a",[Se.Lines]:"#eee",[Se.Cross]:"#e2e2e2"},Kd={[Se.Dots]:1,[Se.Lines]:1,[Se.Cross]:6},Zd=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Qi({id:e,variant:t=Se.Dots,gap:n=20,size:o,lineWidth:r=1,offset:i=2,color:s,style:a,className:c}){const u=w.useRef(null),{transform:l,patternId:f}=ne(Zd,le),d=s||Gd[t],g=o||Kd[t],y=t===Se.Dots,m=t===Se.Cross,E=Array.isArray(n)?n:[n,n],p=[E[0]*l[2]||1,E[1]*l[2]||1],_=g*l[2],N=m?[_,_]:p,b=y?[_/i,_/i]:[N[0]/i,N[1]/i];return C.createElement("svg",{className:de(["react-flow__background",c]),style:oe(X({},a),{position:"absolute",width:"100%",height:"100%",top:0,left:0}),ref:u,"data-testid":"rf__background"},C.createElement("pattern",{id:f+e,x:l[0]%p[0],y:l[1]%p[1],width:p[0],height:p[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${b[0]},-${b[1]})`},y?C.createElement(Ud,{color:d,radius:_/i}):C.createElement(Wd,{dimensions:N,color:d,lineWidth:r})),C.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}Qi.displayName="Background";var qd=w.memo(Qi);const jd=({title:e="Tool Canvas",actions:t,className:n=""})=>q.jsxs("header",{className:`flex items-center justify-between p-4 bg-gray-800 border-b border-gray-700 ${n}`,role:"banner",children:[q.jsx("h1",{className:"text-lg font-semibold text-white",children:e}),q.jsx("div",{className:"flex items-center gap-2",role:"toolbar","aria-label":"Toolbar actions",children:t.map(o=>q.jsx(nn,{variant:o.variant,onClick:o.onClick,disabled:o.disabled,"aria-label":o["aria-label"],"aria-expanded":o["aria-expanded"],"aria-haspopup":o["aria-haspopup"],description:o.label},o.id))})]}),Jd=({options:e,isVisible:t,onSelect:n,onClose:o,title:r="Select an option",position:i="left"})=>{const s=w.useRef(null),a=w.useRef(null);if(w.useEffect(()=>(t?(setTimeout(()=>{s.current?s.current.focus():a.current&&a.current.focus()},0),document.body.style.overflow="hidden"):document.body.style.overflow="unset",()=>{document.body.style.overflow="unset"}),[t]),!t)return null;const c=l=>{l.disabled||n(l)},u=l=>{l.key==="Escape"&&o()};return q.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-start justify-start p-4",onClick:o,children:q.jsxs("div",{ref:a,className:`bg-white rounded-lg shadow-xl w-fit max-w-md mt-20 ${i==="right"?"ml-auto":"mr-auto"}`,onClick:l=>l.stopPropagation(),onKeyDown:u,role:"dialog","aria-modal":"true","aria-labelledby":"side-menu-title",tabIndex:-1,children:[q.jsxs("header",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[q.jsx("h3",{id:"side-menu-title",className:"text-xl font-semibold text-gray-900",children:r}),q.jsx("button",{onClick:o,"aria-label":"Close menu",className:"text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-full transition-colors",title:"Close",children:q.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[q.jsx("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),q.jsx("line",{x1:"6",y1:"6",x2:"18",y2:"18"})]})})]}),q.jsx("div",{className:"p-6",children:e.length===0?q.jsx("p",{className:"text-base text-gray-500 text-center py-6",children:"No options available"}):q.jsx("div",{className:"space-y-3",children:e.map(l=>q.jsx(nn,{variant:"ghost",onClick:()=>c(l),disabled:l.disabled,className:`w-full text-left justify-start p-4 border border-gray-200 rounded-lg transition-all duration-200 ${l.disabled?"opacity-50 cursor-not-allowed border-gray-100":l.isUsed||l.isActive?"border-2 border-blue-500 bg-blue-50 text-blue-700 hover:bg-blue-100":"hover:bg-gray-50 hover:border-gray-300"}`,"aria-label":`Select ${l.title}`,description:l.description||""},l.id))})})]})})},Qd=({isVisible:e,items:t,onSelect:n,onClose:o,title:r="Select an item",position:i="left"})=>{const s=t.map(c=>({id:c.id,title:c.title,description:c.description,value:c,disabled:c.disabled})),a=c=>{n(c.value),o()};return q.jsx(Jd,{options:s,isVisible:e,onSelect:a,onClose:o,title:r,position:i})},eh=({isVisible:e,availableTools:t,onSelectTool:n,onClose:o,title:r="Select a tool to add"})=>{const i=t.map(a=>({id:a.name,title:a.displayName,description:a.description})),s=a=>{const c=t.find(u=>u.name===a.id);c&&n(c)};return q.jsx(Qd,{isVisible:e,items:i,onSelect:s,onClose:o,title:r,position:"left",emptyMessage:"No tools available"})},th=({isVisible:e,description:t,onCancel:n,onConfirm:o})=>e?q.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center p-4",children:q.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full border border-gray-200",role:"dialog","aria-modal":"true","aria-labelledby":"modal-description",children:q.jsxs("div",{className:"p-6",children:[q.jsx("div",{className:"text-center",children:q.jsx("p",{id:"modal-description",className:"text-base text-gray-900 mb-6",children:t})}),q.jsxs("div",{className:"flex gap-3 justify-center",children:[q.jsx(nn,{variant:"outline",onClick:n,description:"Cancel"}),q.jsx(nn,{variant:"destructive",onClick:o,description:"Remove"})]})]})})}):null,ye={REM_TO_PX_RATIO:16,TOOL_WIDTH_PX:250,TOOL_HEIGHT_PX:200,SPACING_REM:2,MARGIN_REM:2,ROW_THRESHOLD_REM:1,CANVAS_PADDING:40,DEFAULT_CANVAS_WIDTH:800,DEFAULT_CANVAS_HEIGHT:600,FOCUS_DELAY_MS:100},jt={TOOL_CANVAS_STATE:"tool-canvas-state"},wr={DEFAULT_WEATHER_TOOL:"default-weather-tool"},nh=()=>Date.now().toString()+Math.random().toString(36).substr(2,9),oh=e=>new Set(e.map(t=>t.name)),br=()=>typeof window!="undefined"&&window.innerWidth<=768,rh=e=>{if(e.length===0)return{x:ye.MARGIN_REM,y:ye.MARGIN_REM};const t=ye.TOOL_WIDTH_PX/ye.REM_TO_PX_RATIO,n=ye.TOOL_HEIGHT_PX/ye.REM_TO_PX_RATIO,o=br()?1:2;return br()?ih(e,{toolWidth:t,toolHeight:n,spacing:o,margin:ye.MARGIN_REM}):sh(e,{toolWidth:t,toolHeight:n,spacing:o,margin:ye.MARGIN_REM,rowThreshold:ye.ROW_THRESHOLD_REM})},ih=(e,t)=>{const n=e.reduce((o,r)=>r.position.y>o.position.y?r:o);return{x:t.margin,y:n.position.y+t.toolHeight+t.spacing}},sh=(e,t)=>{const n=50-t.margin,o=[];e.forEach(r=>{const i=o.find(s=>Math.abs(s[0].position.y-r.position.y)<t.rowThreshold);i?i.push(r):o.push([r])}),o.sort((r,i)=>r[0].position.y-i[0].position.y);for(const r of o){r.sort((u,l)=>u.position.x-l.position.x);const i=r[r.length-1],s=t.toolWidth,a=i.position.x+s+t.spacing,c=t.toolWidth;if(a+c<=n)return{x:a,y:i.position.y}}if(o.length>0){const i=o[o.length-1][0].position.y+t.toolHeight+t.spacing;return{x:t.margin,y:i}}return{x:t.margin,y:t.margin}},ah=(e,t)=>({id:nh(),name:e.name,params:X({},e.defaultParams),position:rh(t)}),ch=({tools:e,setTools:t})=>{const n=w.useMemo(()=>{const c=oh(e);return Is.filter(u=>!c.has(u.name))},[e]),o=w.useCallback(c=>{let u="";return t(l=>{const f=ah(c,l);return u=f.id,[...l,f]}),u},[t]),r=w.useCallback((c,u)=>{t(l=>l.map(f=>f.id===c?X(X({},f),u):f))},[t]),i=w.useCallback(c=>{t(u=>u.filter(l=>l.id!==c))},[t]),s=w.useCallback(()=>{t([])},[t]),a=w.useCallback(()=>{const c={tools:e,timestamp:new Date().toISOString(),version:"1.0.0"},u=JSON.stringify(c,null,2),l=new Blob([u],{type:"application/json"}),f=URL.createObjectURL(l),d=document.createElement("a");d.href=f,d.download=`tool-canvas-export-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(f)},[e]);return{addTool:o,tools:e,updateTool:r,deleteTool:i,clearTools:s,exportTools:a,availableTools:n}},vr=e=>e/ye.REM_TO_PX_RATIO,lh=e=>({x:Math.max(0,vr(e.width-ye.TOOL_WIDTH_PX)/2),y:Math.max(0,vr(e.height-ye.TOOL_HEIGHT_PX)/2)}),uh=()=>{const e=w.useRef(!0),t=w.useRef(""),n=w.useRef(null),[o,r]=w.useState([]);w.useEffect(()=>{const c=()=>{try{const u=localStorage.getItem(jt.TOOL_CANVAS_STATE);if(u){const l=JSON.parse(u);Array.isArray(l)&&l.length>0&&r(l)}else r([{id:"test-tool-1",name:"get_weather",params:{location:"Durham, NC",date:"tomorrow"},position:{x:100,y:100}}])}catch(u){}};"requestIdleCallback"in window?requestIdleCallback(c,{timeout:1e3}):setTimeout(c,100),e.current=!1},[]),w.useEffect(()=>{if(e.current)return;if(o.length===0){t.current!==""&&(localStorage.removeItem(jt.TOOL_CANVAS_STATE),t.current="");return}const c=JSON.stringify(o);if(c!==t.current)return n.current&&clearTimeout(n.current),n.current=window.setTimeout(()=>{try{const u=()=>{localStorage.setItem(jt.TOOL_CANVAS_STATE,c),t.current=c};"requestIdleCallback"in window?requestIdleCallback(u,{timeout:2e3}):u()}catch(u){}},500),()=>{n.current&&clearTimeout(n.current)}},[o]);const i=w.useCallback(()=>{r(c=>c.some(l=>l.id===wr.DEFAULT_WEATHER_TOOL)?c.map(l=>l.id===wr.DEFAULT_WEATHER_TOOL?oe(X({},l),{position:lh()}):l):c)},[]),s=w.useCallback(()=>{localStorage.removeItem(jt.TOOL_CANVAS_STATE),t.current=""},[]),a=w.useCallback(()=>JSON.stringify(o)!==t.current,[o]);return{tools:o,setTools:r,updateDefaultToolPosition:i,clearStorage:s,hasUnsavedChanges:a}},fh=({data:e})=>q.jsx(Ds,{tool:e.tool,onUpdate:e.onUpdateTool,onDelete:e.onDeleteTool,isNew:!1}),dh=()=>{const{tools:e,setTools:t}=uh(),{addTool:n,updateTool:o,clearTools:r,exportTools:i,availableTools:s,deleteTool:a}=ch({tools:e,setTools:t}),[c,u,l]=Md([]),[f,d]=w.useState(!1),[g,y]=w.useState(!1),m=w.useMemo(()=>e.map((H,k)=>({id:H.id,type:"toolNode",position:H.position||{x:100+k*300,y:100+k*200},data:{tool:H,onDeleteTool:a,onUpdateTool:o},draggable:!0})),[e]),E=w.useMemo(()=>({toolNode:fh}),[]),[p,_,N]=Cd(m);C.useEffect(()=>{_(m)},[m,_]);const b=w.useCallback((H,k)=>{t(h=>h.map(S=>S.id===H?oe(X({},S),{position:k}):S))},[t]),M=w.useCallback(H=>{n(H),d(!1)},[n]),$=w.useCallback(()=>{i()},[i]),O=w.useCallback(()=>{y(!0)},[]),B=w.useCallback(()=>{r(),y(!1)},[r]),R=w.useCallback(()=>{y(!1)},[]),z=w.useCallback(H=>{u(k=>hi(H,k))},[u]),L=[{id:"add-tool",label:"Add Tool",variant:"primary",onClick:()=>d(!0),"aria-expanded":f,"aria-haspopup":"menu","aria-label":"Add a new tool to the canvas"},{id:"export",label:"Export",variant:"outline",onClick:$,disabled:e.length===0,"aria-label":"Export current canvas configuration as JSON file"},{id:"clear",label:"Clear All",variant:"destructive",onClick:O,disabled:e.length===0,"aria-label":"Remove all tools from the canvas"}];return q.jsxs("div",{className:"w-full h-screen",children:[q.jsx(jd,{title:"Tool Canvas",actions:L}),f&&q.jsx(eh,{isVisible:f,availableTools:s,onSelectTool:M,onClose:()=>d(!1)}),q.jsx(th,{isVisible:g,description:"Are you sure you want to remove all tools from the canvas?",onConfirm:B,onCancel:R}),q.jsx("div",{className:"flex-1 h-full bg-white",children:q.jsxs(Ki,{nodes:p,edges:c,nodeTypes:E,onNodesChange:H=>{N(H),H.forEach(k=>{k.type==="position"&&k.position&&b(k.id,k.position)})},onEdgesChange:l,onConnect:z,defaultViewport:{x:0,y:0,zoom:0},fitView:!0,children:[q.jsx(Yd,{}),q.jsx(Od,{}),q.jsx(qd,{gap:12,size:1})]})})]})};function hh(){return q.jsx(dh,{})}const es=document.getElementById("root");if(!es)throw new Error("Root element not found");const gh=()=>{_r(es).render(q.jsx(hh,{}))};gh();
